diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAnalogNoiseAndDrift.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAnalogNoiseAndDrift.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAnalogNoiseAndDrift.cs	2011-06-16 16:28:22.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAnalogNoiseAndDrift.cs	2015-01-16 16:26:10.000000000 -0500
@@ -27,20 +27,21 @@
   /// <summary>
   /// Summary description for TUVAnalogNoiseAndDrift.
   /// </summary>
   [ComVisible(false)]
   public class TUVAnalogNoiseAndDrift : Waters.ACQUITY.DiagDialogBaseClass
   {
     #region Private Constants
     string NOISETEST   = Resources.GetString("TUVAnalogNoiseAndDrift_NoiseTest");
     string DRIFTTEST   = Resources.GetString("TUVAnalogNoiseAndDrift_DriftTest");
   private string filename, keyword;
+    private IdentityInfo identityInfo = Identity.Info();
     #endregion

         #region Private Fields
     private IRemoteTUV iRemoteTUV = null;

     private Waters.ACQUITY.ConsoleButton startStopButton;
     private Waters.ACQUITY.ConsoleButton closeButton;

     private Waters.ACQUITY.ConsoleLabel functionState;
     private Waters.Controls.CounterControl runtimeCounter;
@@ -971,22 +972,23 @@


       private void testSelectInput_SelectionChangeCommitted(object sender, System.EventArgs e)
       {

       }

   private void TUVAnalogNoiseAndDrift_Activated(object sender, System.EventArgs e)
   {
     F1HelpFilter.GetHelpID(ref filename, ref keyword);
+        F1HelpFilter.SetHelpID(identityInfo, this, "Noise and Drift");
     //F1HelpFilter.SetHelpID(this,null, "Troubleshooting_and_Resolving_Problems/Solving_baseline_noise_and_drift_problems.htm");
-        F1HelpFilter.SetHelpID(this, "acqtuv.chm::", @"Maintaining_the_TUV_Detector\Determining_the_status_of_the_TUV_Detector.htm#TestNoiseDrift");
+        //F1HelpFilter.SetHelpID(this, "acqtuv.chm::", @"Maintaining_the_TUV_Detector\Determining_the_status_of_the_TUV_Detector.htm#TestNoiseDrift");
   }

   private void TUVAnalogNoiseAndDrift_Deactivate(object sender, System.EventArgs e)
   {
     F1HelpFilter.SetPreviousHelpID(filename, keyword);
   }
     #endregion

         #region Public Class Methods
       public static string XmlToText(string xmlIn)
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAutoZeroOffsets.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAutoZeroOffsets.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAutoZeroOffsets.resx	2011-06-16 16:28:22.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVAutoZeroOffsets.resx	2015-01-20 11:12:02.000000000 -0500
@@ -775,19 +775,19 @@
   <data name="$this.MinimumSize" type="System.Drawing.Size, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a">
     <value>0, 0</value>
   </data>
   <data name="$this.RightToLeft" type="System.Windows.Forms.RightToLeft, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>Inherit</value>
   </data>
   <data name="$this.StartPosition" type="System.Windows.Forms.FormStartPosition, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>CenterParent</value>
   </data>
   <data name="$this.Text">
-    <value>Auto Zero Offsets</value>
+    <value>Autozero Offsets</value>
   </data>
   <data name="&gt;&gt;$this.Name">
     <value>TUVAutoZeroOffsets</value>
   </data>
   <data name="&gt;&gt;$this.Type">
     <value>System.Windows.Forms.Form, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
   </data>
 </root>
\ No newline at end of file
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.cs	2014-12-09 16:15:00.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.cs	2015-02-17 16:52:12.000000000 -0500
@@ -14,20 +14,28 @@
 using Crownwood.DotNetMagic.Common;
 using System.Diagnostics;
 using MutexSecurity;

 namespace Waters.ACQUITY
   {
   /// <summary>
   /// Summary description for TUVControlPanel.
   /// </summary>
   ///
+  //#if BUILD_2489
+  //  [Guid( "EB00FA3D-E151-40dd-9AD1-6F47052D4879" )]
+  //#else
+  //  [Guid("B2CEA281-8EE9-40cf-B53F-C4500547B9C5")]
+  //#endif
+  [Guid(ServerLibClass.GUID_CONTROL_PANEL)]
+  [ClassInterface(ClassInterfaceType.AutoDispatch)]
+
   public class TUVControlPanel : System.Windows.Forms.UserControl
     {
     private System.ComponentModel.IContainer components;

     [ComRegisterFunctionAttribute]
     public static void RegisterFunction(Type t)
       {
       ComHelper.RegisterSafeForScripting(t);
       }
     [ComUnregisterFunctionAttribute]
@@ -1183,21 +1191,21 @@
     private void autozeroMenu_Click(object sender, System.EventArgs e)
       {
       Autozero();

       }

     private void SetChannelAVisibility(bool shutterOpen, bool hideAllFields)
       {
       this.label10.Visible = !hideAllFields;
       this.channelAAbsorbance.Visible = !hideAllFields && shutterOpen;
-      this.channelAAULabel.Visible = !hideAllFields && shutterOpen;
+      this.channelAAULabel.Visible = !hideAllFields && bLampOn && shutterOpen;
       this.waveBoxA.Visible = !hideAllFields;
       this.consoleLabel3.Visible = !hideAllFields;
       }

     private void SetChannelBVisibility(bool dual, bool shutterOpen, bool hideAllFields)
       {
       this.label27.Visible = !hideAllFields && dual;
       this.channelBAbsorbance.Visible = dual && (!hideAllFields && shutterOpen);
       this.channelBAULabel.Visible = dual && (!hideAllFields && bLampOn && shutterOpen);
       this.waveBoxB.Visible = !hideAllFields && dual;
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.resx	2015-01-14 16:43:42.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVControlPanel.resx	2012-11-08 16:31:44.000000000 -0500
@@ -450,21 +450,21 @@
   <data name="consoleLabel1.Location" type="System.Drawing.Point, System.Drawing">
     <value>0, 6</value>
   </data>
   <data name="consoleLabel1.Size" type="System.Drawing.Size, System.Drawing">
     <value>157, 16</value>
   </data>
   <data name="consoleLabel1.TabIndex" type="System.Int32, mscorlib">
     <value>0</value>
   </data>
   <data name="consoleLabel1.Text" xml:space="preserve">
-    <value>UV Detector</value>
+    <value>TUV Detector</value>
   </data>
   <data name="&gt;&gt;consoleLabel1.Name" xml:space="preserve">
     <value>consoleLabel1</value>
   </data>
   <data name="&gt;&gt;consoleLabel1.Type" xml:space="preserve">
     <value>Waters.ACQUITY.ConsoleLabel, Waters.ACQUITY.Utilities, Version=1.60.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;consoleLabel1.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetector.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetector.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetector.resx	2015-01-14 16:45:38.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetector.resx	2015-01-20 11:12:02.000000000 -0500
@@ -159,21 +159,21 @@
   <data name="TUVNewScan_Peak" xml:space="preserve">
     <value>    Peak {0}:\r\n</value>
   </data>
   <data name="TUVControlPanel_WavelengthAPrompt" xml:space="preserve">
     <value>{0} A</value>
   </data>
   <data name="TUVSchematic_SerialNumber" xml:space="preserve">
     <value>SN: </value>
   </data>
   <data name="TUVControlPanel_AutoZero" xml:space="preserve">
-    <value>Auto zero</value>
+    <value>Autozero</value>
   </data>
   <data name="Menu_PlotProperties" xml:space="preserve">
     <value>Plot properties...</value>
   </data>
   <data name="TUVSystemChangeWavelengthButton" xml:space="preserve">
     <value>Change detector wavelength.</value>
   </data>
   <data name="Menu_MinimizeInitialization" xml:space="preserve">
     <value>Minimize initialization</value>
   </data>
@@ -204,39 +204,39 @@
   <data name="TUVChangeLamp_GoodIgnitions" xml:space="preserve">
     <value>    Good Ignitions: {0}\r\n</value>
   </data>
   <data name="TUVDetectorNoiseAndDrift_ResultsNoise" xml:space="preserve">
     <value>    Segment Peak Noise: {0} µAU\r\n</value>
   </data>
   <data name="MinimizeInit_Caption" xml:space="preserve">
     <value>Reduce Warmup Time and Skip Erbium Peak Verification?</value>
   </data>
   <data name="ModuleInfo_Caption" xml:space="preserve">
-    <value>UV Detector Module Information</value>
+    <value>TUV Detector Module Information</value>
   </data>
   <data name="LampCounter_Caption" xml:space="preserve">
     <value>Lamp Life Indicator</value>
   </data>
   <data name="Response_No" xml:space="preserve">
     <value>No</value>
   </data>
   <data name="State_Delimiter" xml:space="preserve">
     <value>: </value>
   </data>
   <data name="TUVCalLeakDetectors_Heating" xml:space="preserve">
     <value>Heating</value>
   </data>
   <data name="TUVDetectorNoiseAndDrift_ResultsDrift" xml:space="preserve">
     <value>    Drift: {0} µAU\r\n</value>
   </data>
   <data name="TUVDetectorNoiseAndDrift_ResultsTitle" xml:space="preserve">
-    <value>UV Detector: Noise/Drift\r\n</value>
+    <value>TUV Detector: Noise/Drift\r\n</value>
   </data>
   <data name="TUVNewScan_ZeroScanMessage" xml:space="preserve">
     <value>A zero scan must be executed with these parameters before a sample scan can be started.</value>
   </data>
   <data name="TUVAnalogNoiseAndDrift_NoiseTest" xml:space="preserve">
     <value>Noise Test</value>
   </data>
   <data name="TUVAnalogNoiseAndDrift_DriftTest" xml:space="preserve">
     <value>Drift Test</value>
   </data>
@@ -282,39 +282,39 @@
   <data name="FilterType_Erbium" xml:space="preserve">
     <value>Erbium</value>
   </data>
   <data name="Menu_Configure" xml:space="preserve">
     <value>Configure</value>
   </data>
   <data name="WavelengthModeCaption" xml:space="preserve">
     <value>Wavelength Mode</value>
   </data>
   <data name="Menu_AutoZeroOffsets" xml:space="preserve">
-    <value>Auto zero offsets...</value>
+    <value>Autozero offsets...</value>
   </data>
   <data name="LampCounter_Prompt" xml:space="preserve">
     <value>lamp life</value>
   </data>
   <data name="TUVCalLeakDetector_CalibrationValue" xml:space="preserve">
     <value>    Calibration Value: {0}\r\n</value>
   </data>
   <data name="TUVChangeLamp_Date" xml:space="preserve">
     <value>Date: </value>
   </data>
   <data name="Menu_Maintain" xml:space="preserve">
     <value>Maintain</value>
   </data>
   <data name="Scan_PrintFontName" xml:space="preserve">
     <value>Microsoft Sans Serif</value>
   </data>
   <data name="ResetNVRam_Warning" xml:space="preserve">
-    <value>You are about to reset the UV Detector non-volatile RAM.\n\nThis will reset the calibration values, causing the loss of the current calibration\n\nDo you want to proceed?</value>
+    <value>You are about to reset theTUV Detector non-volatile RAM.\n\nThis will reset the calibration values, causing the loss of the current calibration\n\nDo you want to proceed?</value>
   </data>
   <data name="TUVNewScan_Wavelength" xml:space="preserve">
     <value>        Wavelength: {0} nm    Absorbance: {1} AU\r\n</value>
   </data>
   <data name="SetWavelengthA_Instrument" xml:space="preserve">
     <value>TUV</value>
   </data>
   <data name="TUVControlPanel_SetLampOff" xml:space="preserve">
     <value>on</value>
   </data>
@@ -327,39 +327,39 @@
   <data name="Config_Ignore" xml:space="preserve">
     <value>Ignore</value>
   </data>
   <data name="Diagnostic_ShowResults" xml:space="preserve">
     <value>Results &gt;&gt;</value>
   </data>
   <data name="Config_Low" xml:space="preserve">
     <value>Low</value>
   </data>
   <data name="PrintPlot_Title" xml:space="preserve">
-    <value>UV Detector Plots</value>
+    <value>TUV Detector Plots</value>
   </data>
   <data name="TUVNewScan_StartEndWavelength" xml:space="preserve">
     <value>End wavelength must be greater than start wavelength.</value>
   </data>
   <data name="ChangeLamp_PrintLineNumber" xml:space="preserve">
     <value>{0}:</value>
   </data>
   <data name="TUV_Title" xml:space="preserve">
-    <value>UV Detector: {0}\r\n</value>
+    <value>TUV Detector: {0}\r\n</value>
   </data>
   <data name="ConfirmWavelengthMode" xml:space="preserve">
     <value>Change to {0} wavelength </value>
   </data>
   <data name="Scan_PrintFontStyle" xml:space="preserve">
     <value>FontStyle.Regular</value>
   </data>
   <data name="MinimizeInit_Warning" xml:space="preserve">
-    <value>You are about to interfere with the UV Detector initialization.\n\nThis will reduce the warmup time for the lamp, which may affect the positional quality of the 656 nm D2 peak reference location.\n\nIt will also skip the erbium peak verification, which may affect the wavelength accuracy of the instrument until it is re-initialized or calibrated.\n\nDo you want to proceed?</value>
+    <value>You are about to interfere with the TUV Detector initialization.\n\nThis will reduce the warmup time for the lamp, which may affect the positional quality of the 656 nm D2 peak reference location.\n\nIt will also skip the erbium peak verification, which may affect the wavelength accuracy of the instrument until it is re-initialized or calibrated.\n\nDo you want to proceed?</value>
   </data>
   <data name="TUVChangeLamp_Hours" xml:space="preserve">
     <value>       Hours: {0}\r\n</value>
   </data>
   <data name="Diagnostic_Failed" xml:space="preserve">
     <value>Failed\r\n</value>
   </data>
   <data name="Menu_ResetTUV" xml:space="preserve">
     <value>Reset TUV</value>
   </data>
@@ -378,21 +378,21 @@
   <data name="TUVSchematic_nm" xml:space="preserve">
     <value> nm</value>
   </data>
   <data name="ResetNVRam_Caption" xml:space="preserve">
     <value>Reset the non-volatile RAM of the instrument?</value>
   </data>
   <data name="SetWavelengthA_Prompt" xml:space="preserve">
     <value>Wavelength A:</value>
   </data>
   <data name="TUVLampHoursWarning" xml:space="preserve">
-    <value>UV Detector lamp hours exceeds warning level</value>
+    <value>TUV Detector lamp hours exceeds warning level</value>
   </data>
   <data name="Diagnostic_Passed" xml:space="preserve">
     <value>Passed\r\n</value>
   </data>
   <data name="State_Off" xml:space="preserve">
     <value>Off</value>
   </data>
   <data name="FilterType_Automatic" xml:space="preserve">
     <value>Automatic</value>
   </data>
@@ -423,24 +423,24 @@
   <data name="TUVNewScan_Range" xml:space="preserve">
     <value>    Range: {0} nm to {1} nm   Scan Rate: {2} nm/min\r\n\r\n</value>
   </data>
   <data name="TUVCalLeakDetectors_Yes" xml:space="preserve">
     <value>Yes</value>
   </data>
   <data name="Default_Wavelength" xml:space="preserve">
     <value>254</value>
   </data>
   <data name="TUVName" xml:space="preserve">
-    <value>UV Detector</value>
+    <value>TUV Detector</value>
   </data>
   <data name="TUVNewScan_Title" xml:space="preserve">
-    <value>UV Detector: Scan\r\n</value>
+    <value>TUV Detector: Scan\r\n</value>
   </data>
   <data name="TUV_Name" xml:space="preserve">
     <value>TUV</value>
   </data>
   <data name="TUVChangeLamp_State" xml:space="preserve">
     <value>    State: {0}\r\n</value>
   </data>
   <data name="TUVNewScan_Energy" xml:space="preserve">
     <value>Energy(nA)</value>
   </data>
@@ -456,21 +456,21 @@
   <data name="FilterType_None" xml:space="preserve">
     <value>None</value>
   </data>
   <data name="TUVCalLeakDetectors_Calibrate" xml:space="preserve">
     <value>Calibrate Leak Detector</value>
   </data>
   <data name="TUVSystemAutozeroButton" xml:space="preserve">
     <value>Auto-zero both detector channels.</value>
   </data>
   <data name="TUVSchematic_ExitCaption" xml:space="preserve">
-    <value>UV Detector Interactive</value>
+    <value>TUV Detector Interactive</value>
   </data>
   <data name="Function_LCDataAcquisition" xml:space="preserve">
     <value>LC Data Acquisition</value>
   </data>
   <data name="TUVControlPanel_SetWavelengthA" xml:space="preserve">
     <value>Set Wavelength A</value>
   </data>
   <data name="FilterType_SecondOrder" xml:space="preserve">
     <value>2nd Order</value>
   </data>
@@ -486,21 +486,21 @@
   <data name="Menu_CreateLogEntry" xml:space="preserve">
     <value>Create log entry...</value>
   </data>
   <data name="SingleWavelengthMode" xml:space="preserve">
     <value>single</value>
   </data>
   <data name="Menu_ChangeLamp" xml:space="preserve">
     <value>Lamp...</value>
   </data>
   <data name="TUVSchematic_ExitPrompt" xml:space="preserve">
-    <value>The UV Detector is returning to non-interactive mode.</value>
+    <value>The TUV detector is returning to non-interactive mode.</value>
   </data>
   <data name="TUVNewScan_ParameterError" xml:space="preserve">
     <value>Parameter Error</value>
   </data>
   <data name="State_Idle" xml:space="preserve">
     <value>Idle</value>
   </data>
   <data name="ResetNVRam_CyclePower" xml:space="preserve">
     <value>Please cycle instrument power and reset instrument.</value>
   </data>
@@ -644,11 +644,17 @@
   </data>
   <data name="Lamp_resident_id" xml:space="preserve">
     <value>Lamp resident identification</value>
   </data>
   <data name="Flow_cell_resident_id" xml:space="preserve">
     <value>Flow cell resident identification</value>
   </data>
   <data name="Launch_Console" xml:space="preserve">
     <value>Launch Console</value>
   </data>
+  <data name="Preferences_Caption" xml:space="preserve">
+    <value>TUV Preferences</value>
+  </data>
+  <data name="RearPanel_Caption" xml:space="preserve">
+    <value>TUV Detector Rear Panel</value>
+  </data>
 </root>
\ No newline at end of file
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorResources.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorResources.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorResources.cs	2014-11-05 10:02:16.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorResources.cs	2014-09-19 15:21:26.000000000 -0400
@@ -23,25 +23,23 @@
             ResourceManager rm = new System.Resources.ResourceManager(nm, a);
             return rm;
         }

     public static void Initialize(Assembly a)
       {
       if (rm == null)
         {
         assy = a;

-        string rescoll = identityInfo.GetIdentityString("ResourceCollection");
-        if (!string.IsNullOrEmpty(rescoll))
-            name = rescoll;
-        else
-            name = "Waters.ACQUITY." + identityInfo.ConsoleAssy;
+        //AssemblyName assyName = new AssemblyName(a.FullName);
+        //name = assyName.Name;
+        name = "Waters.ACQUITY." + identityInfo.ConsoleAssy;
 #if TUV140_COMPATIBLE
         name = name.Replace("140", "");
 #endif

         rm = _Initialize(name, assy);

         //AddICSResources( tuvType, icsToken, icsResourceFileName );
         if ((identityInfo != null) && identityInfo.IsValid)
           AddICSResources(identityInfo.InstrumentType, identityInfo.FilenameRoot, identityInfo.CoreResources, identityInfo.Resources);
         }
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorTopForm.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorTopForm.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorTopForm.cs	2014-08-27 17:23:10.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVDetectorTopForm.cs	2015-02-17 16:53:38.000000000 -0500
@@ -1140,21 +1140,21 @@

     private void statusLed_Click(object sender, System.EventArgs e)
       {

       }

     private void SetChannelAVisibility(bool shutterOpen, bool hideAllFields)
       {
       this.label10.Visible = !hideAllFields;
       this.channelAAbsorbance.Visible = !hideAllFields && shutterOpen;
-      this.channelAAULabel.Visible = !hideAllFields && shutterOpen;
+      this.channelAAULabel.Visible = !hideAllFields && isLampOn && shutterOpen;
       this.waveBoxA.Visible = !hideAllFields;
       this.consoleLabel3.Visible = !hideAllFields;
       }

     private void SetChannelBVisibility(bool dual, bool shutterOpen, bool hideAllFields)
       {
       this.label27.Visible = !hideAllFields && dual;
       this.channelBAbsorbance.Visible = dual && (!hideAllFields && shutterOpen);
       this.channelBAULabel.Visible = dual && (!hideAllFields && isLampOn && shutterOpen);
       this.waveBoxB.Visible = !hideAllFields && dual;
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.cs	2011-06-16 19:06:12.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.cs	2015-02-06 13:34:58.000000000 -0500
@@ -17,20 +17,23 @@
     private System.ComponentModel.IContainer components;
     private string filename, keyword;
         private Button okButton;
         private Button cancelButton;
         private ParameterToolbar toolBar1;
         private ConsoleRadioButton filterPositionNone;
         private ConsoleRadioButton filterPositionOrder;
         private ConsoleRadioButton filterPositionErbium;
         private ConsoleRadioButton filterPositionShutter;

+        private string helpKeyword;
+        private string helpSubFile = "acqtuv.chm::" ;
+
         ServerLibEnum.TUVFilterPosition filterPosition = ServerLibEnum.TUVFilterPosition.NoFilter;

         public ServerLibEnum.TUVFilterPosition FilterPosition
         {
             get
             {
                 return filterPosition;
             }
             set
             {
@@ -57,21 +60,34 @@
         }

         public TUVFilterPositionForm()
         {
             try
             {
                 //
                 // Required for Windows Form Designer support
                 //
                 InitializeComponent();
+                this.Text = Resources.GetString("TUVName");
                 this.AutoScaleMode = AutoScaleMode.Font;
+
+                //Added for Velox case
+                IdentityInfo identityInfo = Identity.Info();
+                helpKeyword = identityInfo.HelpKeyword("Status_Detector_Components"); //NOTRANSLATE
+                if (helpKeyword == "")
+                    helpKeyword = "Preparing_the_TUV_Detector/setting_gain.htm"; //AcquityTUV case //NOTRANSLATE
+
+                //HelpSubfile
+                string helpSubFilePrex = identityInfo.HelpSubFile;
+                if (helpSubFilePrex != "")
+                    helpSubFile = helpSubFilePrex + @".chm::"; //NOTRANSLATE
+
             }
             catch (Exception) { }
         }

     /// <summary>
     /// Clean up any resources being used.
     /// </summary>
     protected override void Dispose( bool disposing )
     {
       if( disposing )
@@ -299,20 +315,20 @@

         private void cancelButton_Click(object sender, EventArgs e)
         {
             DialogResult = DialogResult.Cancel;
             Close();
         }

         private void TUVFilterPositionForm_Activated(object sender, System.EventArgs e)
         {
             F1HelpFilter.GetHelpID(ref filename, ref keyword);
-            F1HelpFilter.SetHelpID(this, "acqtuv.chm::", "Preparing_the_TUV_Detector/setting_gain.htm");
+            F1HelpFilter.SetHelpID(this, helpSubFile, helpKeyword);
         }

         private void TUVFilterPositionForm_Deactivate(object sender, System.EventArgs e)
         {
             F1HelpFilter.SetDefaultHelpID();
         }

   }
 }
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.resx	2014-12-19 19:31:28.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFilterPositionForm.resx	2011-06-16 16:28:22.000000000 -0400
@@ -604,21 +604,21 @@
   <metadata name="$this.Localizable" type="System.Boolean, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
   <data name="$this.ClientSize" type="System.Drawing.Size, System.Drawing">
     <value>186, 178</value>
   </data>
   <data name="$this.StartPosition" type="System.Windows.Forms.FormStartPosition, System.Windows.Forms">
     <value>CenterParent</value>
   </data>
   <data name="$this.Text" xml:space="preserve">
-    <value>UV Detector</value>
+    <value>TUV Detector</value>
   </data>
   <data name="&gt;&gt;imageList1.Name" xml:space="preserve">
     <value>imageList1</value>
   </data>
   <data name="&gt;&gt;imageList1.Type" xml:space="preserve">
     <value>System.Windows.Forms.ImageList, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
   </data>
   <data name="&gt;&gt;$this.Name" xml:space="preserve">
     <value>TUVFilterPositionForm</value>
   </data>
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFormManager.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFormManager.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFormManager.cs	2015-02-06 18:58:02.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVFormManager.cs	2014-12-09 14:21:30.000000000 -0500
@@ -41,21 +41,21 @@
         void CancelAutoZero(ServerLibEnum.TUVChannel ch);  // enum changed
         void SetSwitchState(ServerLibEnum.TUVSwitches sw, bool bOn);  // enum changed
         void SetFilterPosition(ServerLibEnum.TUVFilterPosition pos);  // enum changed
     };

     #region Do Not Translate

   /// <summary>
   /// Summary description for TUVFormManager.
   /// </summary>
-  public class TUVFormManager : IFormManager2, ILeakDetectors, IConsoleArguments, ITUVFormManagerCompatibility
+    public class TUVFormManager : IStartupFormManager, ILeakDetectors, IConsoleArguments, ITUVFormManagerCompatibility
     {
       private class TUVFormManagerCompatibility
       {
           internal ServerLibEnum.TUVFilterPosition filterPosition = ServerLibEnum.TUVFilterPosition.NoFilter;
       }

       #region Private Fields
     private TUVDetectorTopForm tuvDetectorTopForm = null;
     private TUVSchematicForm tuvSchematicForm = null;
     private IRemoteTUV iRemoteTUV = null;
@@ -78,34 +78,34 @@

     private ConsoleToolBar systemToolBar;

     private InstrumentImage instrumentImage = null;

     //private string instrumentId = "TUV"; // NOTRANSLATE
     private string instrumentId = string.Empty;

     private string consoleArgs = string.Empty;

-    //private MessageLog log = null;
-    //private TUVEquilControl tuvEquilControl = null;
-    //private TUVStartupSettings tuvStartupSettings = null;
+    private MessageLog log = null;
+    private TUVEquilControl tuvEquilControl = null;
+    private TUVStartupSettings tuvStartupSettings = null;

     private IdentityInfo identityInfo = Identity.Info();

     enum Stage
       {
       Null=0,
       SettingMethod=1
       };

-    //private Stage startupStage = Stage.Null;
-    //private StState startupState;
+    private Stage startupStage = Stage.Null;
+    private StState startupState;

     #endregion

     public TUVFormManager()
       {
       }

     #region IFormManager Members

     public void Initialize(string instId, Form mdiParentForm, EventHandler showSystemHandler, EventHandler showPageHandler)
@@ -643,73 +643,58 @@

     #region ITUVFormManagerCompatibility Members

     private bool? _IsServer140 = null;
     public bool IsServer140
     {
         get
         {
             if (_IsServer140 == null)
             {
-                if (TryBrandResources.CompanyName == "Waters")
-                {
-                    int major, minor;
-                    string version = IcsVersion(out major, out minor);
-                    _IsServer140 = (major == 1 && minor == 40);
-                }
-                else
-                    _IsServer140 = false;
+                int major, minor;
+                string version = IcsVersion(out major, out minor);
+                _IsServer140 = (major == 1 && minor == 40);
             }

             return (_IsServer140 == null) ? false : (bool)_IsServer140;
         }
     }

     private bool? _IsServer150 = null;
     public bool IsServer150(bool orLater)
     {
         if (_IsServer150 == null)
         {
-            if (TryBrandResources.CompanyName == "Waters")
-            {
-                int major, minor;
-                string version = IcsVersion(out major, out minor);
+            int major, minor;
+            string version = IcsVersion(out major, out minor);

-                if (orLater)
-                    _IsServer150 = (major > 1 || (major == 1 && minor >= 50));
-                else
-                    _IsServer150 = (major == 1 && minor >= 50 && minor < 60);
-            }
+            if (orLater)
+                _IsServer150 = (major > 1 || (major == 1 && minor >= 50));
             else
-                _IsServer150 = orLater;
+                _IsServer150 = (major == 1 && minor >= 50 && minor < 60);
         }

         return (_IsServer150 == null) ? false : (bool)_IsServer150;
     }

     private bool? _IsServer160 = null;
     public bool IsServer160(bool orLater)
     {
         if (_IsServer160 == null)
         {
-            if (TryBrandResources.CompanyName == "Waters")
-            {
-                int major, minor;
-                string version = IcsVersion(out major, out minor);
+            int major, minor;
+            string version = IcsVersion(out major, out minor);

-                if (orLater)
-                    _IsServer160 = (major > 1 || (major == 1 && minor >= 60));
-                else
-                    _IsServer160 = (major == 1 && (minor >= 60 && minor < 70));
-            }
+            if (orLater)
+                _IsServer160 = (major > 1 || (major == 1 && minor >= 60));
             else
-                _IsServer160 = true;
+                _IsServer160 = (major == 1 && (minor >= 60 && minor < 70));
         }

         return (_IsServer160 == null) ? false : (bool)_IsServer160;
     }

     private string _ClientVersion = null;
     public string ClientVersion
     {
         get
         {
@@ -1172,13 +1157,179 @@
                 }
             }
 #else
             if (IsServer150(true))
                 iRemoteTUV.SetFilterPosition(pos);
 #endif
         }
     }

     #endregion
+
+    #region IStartupFormManager Members
+
+    public UserControl CharacterizeControl
+    {
+        get
+        {
+            return null;
+        }
+    }
+
+
+    public UserControl EquilControl
+    {
+        get
+        {
+            if (tuvEquilControl == null)
+                tuvEquilControl = new TUVEquilControl();
+
+            return tuvEquilControl;
+        }
+    }
+
+
+    public void LoadSettings()
+    {
+    }
+
+    public string Get(string parameter)
+    {
+        return null;
+    }
+
+    public UserControl PrimeControl
+    {
+        get
+        {
+            return null;
+        }
+    }
+
+
+    public MessageLog Log
+    {
+        get
+        {
+            return log;
+        }
+        set
+        {
+            log = value;
+        }
+    }
+
+    public void Set(string parameter, string value)
+    {
+    }
+
+    public void UpdateData(bool readFromForms)
+    {
+    }
+
+    public bool Validate(out string msg)
+    {
+        msg = "";
+        return true;
+    }
+
+    public XmlDocument doc
+    {
+        get
+        {
+            return new XmlDocument();
+        }
+    }
+
+    #endregion
+
+    #region IStartup Members
+
+    public bool AdvanceStartup()
+    {
+        return true;
+    }
+
+    public void DefaultNanoSettings()
+    {
+        log.Post(this, "Setting nano defaults"); //NOTRANSLATE
+        tuvStartupSettings.SetNanoDefaults();
+        ((TUVEquilControl)EquilControl).Apply(tuvStartupSettings.parameters);
+    }
+
+    public void DefaultSettings()
+    {
+        log.Post(this, "Setting defaults"); //NOTRANSLATE
+        tuvStartupSettings.SetDefaults();
+        ((TUVEquilControl)EquilControl).Apply(tuvStartupSettings.parameters);
+    }
+
+    public void InterruptStartup()
+    {
+    }
+
+    public bool LogResult(string functionName, string instrumentName, string context)
+    {
+        return true;
+    }
+
+    public void RestoreSettings()
+    {
+        if (tuvStartupSettings == null)
+            tuvStartupSettings = new TUVStartupSettings(this.instrumentId);
+
+        tuvStartupSettings.Restore();
+        ((TUVEquilControl)EquilControl).Apply(tuvStartupSettings.parameters);
+    }
+
+    public bool RunStartup()
+    {
+        log.Post(this, "RunStartup() begins"); // NOTRANSLATE
+        if( iRemoteTUV != null )
+        {
+            iRemoteTUV.SetLamp(tuvStartupSettings.parameters.lampOn);
+        }
+        return true;
+    }
+
+    public string Settings
+    {
+        get
+        {
+            return null;
+        }
+        set
+        {
+        }
+    }
+
+    public int StartupStage
+    {
+        get
+        {
+            return (int)this.startupStage;
+        }
+        set
+        {
+            if (this.StartupState == StState.Idle)
+                this.startupStage = (Stage)value;
+        }
+    }
+
+    public StState StartupState
+    {
+        get
+        {
+            return this.startupState;
+        }
+    }
+
+    public void StoreSettings()
+    {
+        ((TUVEquilControl)EquilControl).Retrieve(tuvStartupSettings.parameters);
+        tuvStartupSettings.Store();
+    }
+
+    #endregion
     }
   #endregion
   }
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.cs	2014-08-27 17:18:20.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.cs	2015-01-12 15:06:14.000000000 -0500
@@ -23,20 +23,21 @@

     public TUVPreferences(IRemoteTUV iRemote)
       {
       //
       // Required for Windows Form Designer support
       //
       InitializeComponent();

       lampMemDeviceCheckBox.Text = Resources.GetString("Lamp_resident_id");
       flowCellMemDeviceCheckBox.Text = Resources.GetString("Flow_cell_resident_id");
+      this.Text = Resources.GetString("Preferences_Caption");

       iRemoteTUV = iRemote;
       }

     public bool RequireLampMemDevice
       {
       get
         {
         return lampMemDeviceCheckBox.Checked;
         }
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.resx	2015-01-28 13:59:54.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVPreferences.resx	2014-08-27 15:33:18.000000000 -0400
@@ -134,21 +134,21 @@
   <data name="afterPeriodOfInactivityRadioButton.TabIndex" type="System.Int32, mscorlib">
     <value>3</value>
   </data>
   <data name="afterPeriodOfInactivityRadioButton.Text" xml:space="preserve">
     <value>After 10 minutes of inactivity</value>
   </data>
   <data name="&gt;&gt;afterPeriodOfInactivityRadioButton.Name" xml:space="preserve">
     <value>afterPeriodOfInactivityRadioButton</value>
   </data>
   <data name="&gt;&gt;afterPeriodOfInactivityRadioButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;afterPeriodOfInactivityRadioButton.Parent" xml:space="preserve">
     <value>shutterControlGroupBox</value>
   </data>
   <data name="&gt;&gt;afterPeriodOfInactivityRadioButton.ZOrder" xml:space="preserve">
     <value>0</value>
   </data>
   <data name="neverRadioButton.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -164,21 +164,21 @@
   <data name="neverRadioButton.TabIndex" type="System.Int32, mscorlib">
     <value>2</value>
   </data>
   <data name="neverRadioButton.Text" xml:space="preserve">
     <value>Never</value>
   </data>
   <data name="&gt;&gt;neverRadioButton.Name" xml:space="preserve">
     <value>neverRadioButton</value>
   </data>
   <data name="&gt;&gt;neverRadioButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;neverRadioButton.Parent" xml:space="preserve">
     <value>shutterControlGroupBox</value>
   </data>
   <data name="&gt;&gt;neverRadioButton.ZOrder" xml:space="preserve">
     <value>1</value>
   </data>
   <data name="shutterControlLabel.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -194,21 +194,21 @@
   <data name="shutterControlLabel.TabIndex" type="System.Int32, mscorlib">
     <value>1</value>
   </data>
   <data name="shutterControlLabel.Text" xml:space="preserve">
     <value>Close shutter:</value>
   </data>
   <data name="&gt;&gt;shutterControlLabel.Name" xml:space="preserve">
     <value>shutterControlLabel</value>
   </data>
   <data name="&gt;&gt;shutterControlLabel.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleLabel, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleLabel, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;shutterControlLabel.Parent" xml:space="preserve">
     <value>shutterControlGroupBox</value>
   </data>
   <data name="&gt;&gt;shutterControlLabel.ZOrder" xml:space="preserve">
     <value>2</value>
   </data>
   <data name="shutterControlGroupBox.Font" type="System.Drawing.Font, System.Drawing">
     <value>Tahoma, 8.25pt, style=Bold</value>
   </data>
@@ -221,21 +221,21 @@
   <data name="shutterControlGroupBox.TabIndex" type="System.Int32, mscorlib">
     <value>0</value>
   </data>
   <data name="shutterControlGroupBox.Text" xml:space="preserve">
     <value>Shutter Control</value>
   </data>
   <data name="&gt;&gt;shutterControlGroupBox.Name" xml:space="preserve">
     <value>shutterControlGroupBox</value>
   </data>
   <data name="&gt;&gt;shutterControlGroupBox.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleGroupBox, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleGroupBox, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;shutterControlGroupBox.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
   <data name="&gt;&gt;shutterControlGroupBox.ZOrder" xml:space="preserve">
     <value>4</value>
   </data>
   <data name="maxCoolingRadioButton.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -251,21 +251,21 @@
   <data name="maxCoolingRadioButton.TabIndex" type="System.Int32, mscorlib">
     <value>4</value>
   </data>
   <data name="maxCoolingRadioButton.Text" xml:space="preserve">
     <value>Maximum cooling</value>
   </data>
   <data name="&gt;&gt;maxCoolingRadioButton.Name" xml:space="preserve">
     <value>maxCoolingRadioButton</value>
   </data>
   <data name="&gt;&gt;maxCoolingRadioButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;maxCoolingRadioButton.Parent" xml:space="preserve">
     <value>opticsTempStabGroupBox</value>
   </data>
   <data name="&gt;&gt;maxCoolingRadioButton.ZOrder" xml:space="preserve">
     <value>0</value>
   </data>
   <data name="elevatedLabTempRadioButton.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -281,21 +281,21 @@
   <data name="elevatedLabTempRadioButton.TabIndex" type="System.Int32, mscorlib">
     <value>3</value>
   </data>
   <data name="elevatedLabTempRadioButton.Text" xml:space="preserve">
     <value>Elevated temperature</value>
   </data>
   <data name="&gt;&gt;elevatedLabTempRadioButton.Name" xml:space="preserve">
     <value>elevatedLabTempRadioButton</value>
   </data>
   <data name="&gt;&gt;elevatedLabTempRadioButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;elevatedLabTempRadioButton.Parent" xml:space="preserve">
     <value>opticsTempStabGroupBox</value>
   </data>
   <data name="&gt;&gt;elevatedLabTempRadioButton.ZOrder" xml:space="preserve">
     <value>1</value>
   </data>
   <data name="normalLabTempRadioButton.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -311,21 +311,21 @@
   <data name="normalLabTempRadioButton.TabIndex" type="System.Int32, mscorlib">
     <value>2</value>
   </data>
   <data name="normalLabTempRadioButton.Text" xml:space="preserve">
     <value>Normal temperature</value>
   </data>
   <data name="&gt;&gt;normalLabTempRadioButton.Name" xml:space="preserve">
     <value>normalLabTempRadioButton</value>
   </data>
   <data name="&gt;&gt;normalLabTempRadioButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleRadioButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;normalLabTempRadioButton.Parent" xml:space="preserve">
     <value>opticsTempStabGroupBox</value>
   </data>
   <data name="&gt;&gt;normalLabTempRadioButton.ZOrder" xml:space="preserve">
     <value>2</value>
   </data>
   <data name="opticsTempStabLabel.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -341,21 +341,21 @@
   <data name="opticsTempStabLabel.TabIndex" type="System.Int32, mscorlib">
     <value>1</value>
   </data>
   <data name="opticsTempStabLabel.Text" xml:space="preserve">
     <value>Setting:</value>
   </data>
   <data name="&gt;&gt;opticsTempStabLabel.Name" xml:space="preserve">
     <value>opticsTempStabLabel</value>
   </data>
   <data name="&gt;&gt;opticsTempStabLabel.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleLabel, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleLabel, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;opticsTempStabLabel.Parent" xml:space="preserve">
     <value>opticsTempStabGroupBox</value>
   </data>
   <data name="&gt;&gt;opticsTempStabLabel.ZOrder" xml:space="preserve">
     <value>3</value>
   </data>
   <data name="opticsTempStabGroupBox.Font" type="System.Drawing.Font, System.Drawing">
     <value>Tahoma, 8.25pt, style=Bold</value>
   </data>
@@ -368,21 +368,21 @@
   <data name="opticsTempStabGroupBox.TabIndex" type="System.Int32, mscorlib">
     <value>1</value>
   </data>
   <data name="opticsTempStabGroupBox.Text" xml:space="preserve">
     <value>Optics Temperature Stabilization</value>
   </data>
   <data name="&gt;&gt;opticsTempStabGroupBox.Name" xml:space="preserve">
     <value>opticsTempStabGroupBox</value>
   </data>
   <data name="&gt;&gt;opticsTempStabGroupBox.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleGroupBox, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleGroupBox, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;opticsTempStabGroupBox.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
   <data name="&gt;&gt;opticsTempStabGroupBox.ZOrder" xml:space="preserve">
     <value>3</value>
   </data>
   <data name="flowCellMemDeviceCheckBox.Font" type="System.Drawing.Font, System.Drawing">
     <value>Tahoma, 8.25pt</value>
   </data>
@@ -399,21 +399,21 @@
   <data name="flowCellMemDeviceCheckBox.TabIndex" type="System.Int32, mscorlib">
     <value>3</value>
   </data>
   <data name="flowCellMemDeviceCheckBox.Text" xml:space="preserve">
     <value>Flow cell resident identification</value>
   </data>
   <data name="&gt;&gt;flowCellMemDeviceCheckBox.Name" xml:space="preserve">
     <value>flowCellMemDeviceCheckBox</value>
   </data>
   <data name="&gt;&gt;flowCellMemDeviceCheckBox.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleCheckBox, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleCheckBox, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;flowCellMemDeviceCheckBox.Parent" xml:space="preserve">
     <value>componentMemDevRepGroupBox</value>
   </data>
   <data name="&gt;&gt;flowCellMemDeviceCheckBox.ZOrder" xml:space="preserve">
     <value>0</value>
   </data>
   <data name="lampMemDeviceCheckBox.Font" type="System.Drawing.Font, System.Drawing">
     <value>Tahoma, 8.25pt</value>
   </data>
@@ -429,21 +429,21 @@
   <data name="lampMemDeviceCheckBox.TabIndex" type="System.Int32, mscorlib">
     <value>2</value>
   </data>
   <data name="lampMemDeviceCheckBox.Text" xml:space="preserve">
     <value>Lamp resident identification</value>
   </data>
   <data name="&gt;&gt;lampMemDeviceCheckBox.Name" xml:space="preserve">
     <value>lampMemDeviceCheckBox</value>
   </data>
   <data name="&gt;&gt;lampMemDeviceCheckBox.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleCheckBox, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleCheckBox, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;lampMemDeviceCheckBox.Parent" xml:space="preserve">
     <value>componentMemDevRepGroupBox</value>
   </data>
   <data name="&gt;&gt;lampMemDeviceCheckBox.ZOrder" xml:space="preserve">
     <value>1</value>
   </data>
   <data name="componentMemDevReqLabel.AutoSize" type="System.Boolean, mscorlib">
     <value>True</value>
   </data>
@@ -459,21 +459,21 @@
   <data name="componentMemDevReqLabel.TabIndex" type="System.Int32, mscorlib">
     <value>1</value>
   </data>
   <data name="componentMemDevReqLabel.Text" xml:space="preserve">
     <value>Require for operation:</value>
   </data>
   <data name="&gt;&gt;componentMemDevReqLabel.Name" xml:space="preserve">
     <value>componentMemDevReqLabel</value>
   </data>
   <data name="&gt;&gt;componentMemDevReqLabel.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleLabel, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleLabel, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;componentMemDevReqLabel.Parent" xml:space="preserve">
     <value>componentMemDevRepGroupBox</value>
   </data>
   <data name="&gt;&gt;componentMemDevReqLabel.ZOrder" xml:space="preserve">
     <value>2</value>
   </data>
   <data name="componentMemDevRepGroupBox.Font" type="System.Drawing.Font, System.Drawing">
     <value>Tahoma, 8.25pt, style=Bold</value>
   </data>
@@ -486,21 +486,21 @@
   <data name="componentMemDevRepGroupBox.TabIndex" type="System.Int32, mscorlib">
     <value>2</value>
   </data>
   <data name="componentMemDevRepGroupBox.Text" xml:space="preserve">
     <value>Component Identification Requirement</value>
   </data>
   <data name="&gt;&gt;componentMemDevRepGroupBox.Name" xml:space="preserve">
     <value>componentMemDevRepGroupBox</value>
   </data>
   <data name="&gt;&gt;componentMemDevRepGroupBox.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleGroupBox, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleGroupBox, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;componentMemDevRepGroupBox.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
   <data name="&gt;&gt;componentMemDevRepGroupBox.ZOrder" xml:space="preserve">
     <value>2</value>
   </data>
   <data name="okButton.Enabled" type="System.Boolean, mscorlib">
     <value>False</value>
   </data>
@@ -519,21 +519,21 @@
   <data name="okButton.TabIndex" type="System.Int32, mscorlib">
     <value>4</value>
   </data>
   <data name="okButton.Text" xml:space="preserve">
     <value>OK</value>
   </data>
   <data name="&gt;&gt;okButton.Name" xml:space="preserve">
     <value>okButton</value>
   </data>
   <data name="&gt;&gt;okButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;okButton.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
   <data name="&gt;&gt;okButton.ZOrder" xml:space="preserve">
     <value>1</value>
   </data>
   <data name="cancelButton.FlatStyle" type="System.Windows.Forms.FlatStyle, System.Windows.Forms">
     <value>System</value>
   </data>
@@ -549,37 +549,37 @@
   <data name="cancelButton.TabIndex" type="System.Int32, mscorlib">
     <value>5</value>
   </data>
   <data name="cancelButton.Text" xml:space="preserve">
     <value>Cancel</value>
   </data>
   <data name="&gt;&gt;cancelButton.Name" xml:space="preserve">
     <value>cancelButton</value>
   </data>
   <data name="&gt;&gt;cancelButton.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleButton, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleButton, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;cancelButton.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
   <data name="&gt;&gt;cancelButton.ZOrder" xml:space="preserve">
     <value>0</value>
   </data>
   <metadata name="$this.Localizable" type="System.Boolean, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
   <data name="$this.ClientSize" type="System.Drawing.Size, System.Drawing">
     <value>370, 569</value>
   </data>
   <data name="$this.StartPosition" type="System.Windows.Forms.FormStartPosition, System.Windows.Forms">
     <value>CenterParent</value>
   </data>
   <data name="$this.Text" xml:space="preserve">
-    <value>UV Preferences</value>
+    <value>TUV Preferences</value>
   </data>
   <data name="&gt;&gt;$this.Name" xml:space="preserve">
     <value>TUVPreferences</value>
   </data>
   <data name="&gt;&gt;$this.Type" xml:space="preserve">
-    <value>Waters.ACQUITY.ConsoleForm, Waters.Console.Utilities, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
+    <value>Waters.ACQUITY.ConsoleForm, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
 </root>
\ No newline at end of file
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.cs	2013-07-26 17:00:14.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.cs	2015-01-12 15:09:20.000000000 -0500
@@ -90,20 +90,21 @@

     public TUVRearPanel(IRemoteTUV iRemote)
       {
       try
         {
         //
         // Required for Windows Form Designer support
         //
         InitializeComponent();
         this.AutoScaleMode = AutoScaleMode.Font;
+        this.Text = Resources.GetString("RearPanel_Caption");

         iRemoteTUV = iRemote;

         ConsoleStyles.ChangeBackground(this, BackgroundStyleType.PanelColor);

         //Setup the threading
         realtimeThread = new Waters.ACQUITY.RealtimeThread(this);
         realtimeThread.DisplayStatusDataEvent += new Waters.ACQUITY.RealtimeThread.DisplayStatusDataHandler(realtimeThread_DisplayStatusDataEvent);
         realtimeThread.RealTimeThreadEvent += new Waters.ACQUITY.RealtimeThread.RealTimeThreadHandler(realtimeThread_RealTimeThreadEvent);
         }
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.resx	2014-12-19 19:32:28.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanel.resx	2015-01-20 11:12:02.000000000 -0500
@@ -1638,21 +1638,21 @@
   <data name="autoZeroLabel.RightToLeft" type="System.Windows.Forms.RightToLeft, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>Inherit</value>
   </data>
   <data name="autoZeroLabel.Size" type="System.Drawing.Size, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a">
     <value>128, 16</value>
   </data>
   <data name="autoZeroLabel.TabIndex" type="System.Int32, mscorlib, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>65</value>
   </data>
   <data name="autoZeroLabel.Text">
-    <value>Auto Zero (In)</value>
+    <value>Autozero (In)</value>
   </data>
   <data name="autoZeroLabel.TextAlign" type="System.Drawing.ContentAlignment, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a">
     <value>MiddleLeft</value>
   </data>
   <data name="autoZeroLabel.Visible" type="System.Boolean, mscorlib, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </data>
   <data name="&gt;&gt;autoZeroLabel.Name">
     <value>autoZeroLabel</value>
   </data>
@@ -4254,21 +4254,21 @@
   <data name="$this.MinimumSize" type="System.Drawing.Size, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a">
     <value>0, 0</value>
   </data>
   <data name="$this.RightToLeft" type="System.Windows.Forms.RightToLeft, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>Inherit</value>
   </data>
   <data name="$this.StartPosition" type="System.Windows.Forms.FormStartPosition, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>CenterParent</value>
   </data>
   <data name="$this.Text">
-    <value>UV Detector Rear Panel</value>
+    <value>TUV Detector Rear Panel</value>
   </data>
   <data name="&gt;&gt;ContactClosureImages.Name">
     <value>ContactClosureImages</value>
   </data>
   <data name="&gt;&gt;ContactClosureImages.Type">
     <value>System.Windows.Forms.ImageList, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
   </data>
   <data name="&gt;&gt;inputImages.Name">
     <value>inputImages</value>
   </data>
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanelReduced.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanelReduced.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanelReduced.resx	2014-12-19 19:33:14.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVRearPanelReduced.resx	2011-06-16 16:28:22.000000000 -0400
@@ -976,21 +976,21 @@
   <metadata name="$this.Localizable" type="System.Boolean, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
   <data name="$this.ClientSize" type="System.Drawing.Size, System.Drawing">
     <value>260, 210</value>
   </data>
   <data name="$this.StartPosition" type="System.Windows.Forms.FormStartPosition, System.Windows.Forms">
     <value>CenterParent</value>
   </data>
   <data name="$this.Text" xml:space="preserve">
-    <value>UV Detector Rear Panel</value>
+    <value>TUV Detector Rear Panel</value>
   </data>
   <data name="&gt;&gt;inputImages.Name" xml:space="preserve">
     <value>inputImages</value>
   </data>
   <data name="&gt;&gt;inputImages.Type" xml:space="preserve">
     <value>System.Windows.Forms.ImageList, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
   </data>
   <data name="&gt;&gt;$this.Name" xml:space="preserve">
     <value>TUVRearPanelReduced</value>
   </data>
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStartupSettings.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStartupSettings.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStartupSettings.cs	2008-10-03 17:17:06.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStartupSettings.cs	2014-12-16 08:58:10.000000000 -0500
@@ -1,39 +1,42 @@
 using System;
 using System.Collections.Generic;
 using System.Text;
 using System.Xml;
 using Microsoft.Win32;

 namespace Waters.ACQUITY
 {
-    internal class TUVStartupSettings : SysStartupSettings
+    internal class TUVStartupSettings : SysStartupSettings2
     {
         public TUVStartupParameters parameters = new TUVStartupParameters();
         public readonly TUVStartupParameters defaults = new TUVStartupParameters();

         public const string lampOnName = "LampOn"; // NOTRANSLATE

-        public const string rootKeyName = @"Software\Waters\Instruments"; // NOTRANSLATE
-        public string tuvKeyName;
+        //public const string rootKeyName = @"Software\Waters\Instruments"; // NOTRANSLATE
+        //public string tuvKeyName;
         private string configName;

-        private TUVStartupSettings()
-        {
-        }
+        //public TUVStartupSettings()
+        //    :base(false, false)
+        //{
+        //}

         public TUVStartupSettings(string id)
+            : base(false, false)
         {
             configName = id;
-            tuvKeyName = rootKeyName + @"\ACQ-TUV\Configurations\" + id + @"\Startup Settings";
+            //tuvKeyName = rootKeyName + @"\ACQ-TUV\Configurations\" + id + @"\Startup Settings";
         }

+
         public override void SetDefaults()
         {
             parameters = new TUVStartupParameters(defaults);
         }

         public override void SetNanoDefaults()
         {
             SetDefaults();
         }

@@ -49,40 +52,58 @@
         public override string ToString()
         {
             string xml =
               "<Startup>" +
               "<LampOn>" + (parameters.lampOn ? "true" : "false") + "</LampOn>" +
               "</Startup>";

             return xml;
         }

-        public override void Restore()
+        public override string Restore()
         {
-            using (RegistryKey key = Registry.LocalMachine.CreateSubKey(tuvKeyName))
+            //using (RegistryKey key = Registry.LocalMachine.CreateSubKey(tuvKeyName))
+            //{
+            //    if (key != null)
+            //    {
+            //        parameters.lampOn = GetBoolean(key, TUVStartupSettings.lampOnName, defaults.lampOn);
+            //    }
+            //}
+            using (new AcquitySettingsLock())
             {
-                if (key != null)
-                {
-                    parameters.lampOn = GetBoolean(key, TUVStartupSettings.lampOnName, defaults.lampOn);
-                }
+                XmlDocument doc = new XmlDocument();
+                doc.Load(AcquitySettings.SettingsFilePath);
+                parameters.lampOn = GetBoolean(doc, lampOnName, true);
             }
+
+            return parameters.ToString();
         }

-        public override void Store()
+        public override string Store()
         {
-            using (RegistryKey key = Registry.LocalMachine.CreateSubKey(tuvKeyName))
+            //using (RegistryKey key = Registry.LocalMachine.CreateSubKey(tuvKeyName))
+            //{
+            //    if (key != null)
+            //    {
+            //        SetBoolean(key, TUVStartupSettings.lampOnName, parameters.lampOn);
+            //    }
+            //}
+            using (new AcquitySettingsLock())
             {
-                if (key != null)
-                {
-                    SetBoolean(key, TUVStartupSettings.lampOnName, parameters.lampOn);
-                }
+                XmlDocument doc = new XmlDocument();
+                doc.Load(AcquitySettings.SettingsFilePath);
+
+                StoreBoolean(doc, lampOnName, parameters.lampOn);
+                doc.Save(AcquitySettings.SettingsFilePath);
             }
+
+            return parameters.ToString();
         }

         public override string ConfigName
         {
             get
             {
                 return configName;
             }
         }

diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.cs	2012-11-07 12:52:14.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.cs	2015-02-17 16:55:08.000000000 -0500
@@ -241,21 +241,21 @@
       catch (Exception ex)
         {
         TraceLog.WriteException(ex);
         }
       }

     private void SetChannelAVisibility(bool shutterOpen, bool hideAllFields)
       {
       this.channelALabel.Visible = !hideAllFields;
       this.channelAAbsorbance.Visible = !hideAllFields && shutterOpen;
-      this.channelAAULabel.Visible = !hideAllFields && shutterOpen;
+      this.channelAAULabel.Visible = !hideAllFields && isLampOn && shutterOpen;
       this.waveBoxA.Visible = !hideAllFields;
       this.channelAnmLabel.Visible = !hideAllFields;
       }

     private void SetChannelBVisibility(bool dual, bool shutterOpen, bool hideAllFields)
       {
       this.channelBLabel.Visible = !hideAllFields && dual;
       this.channelBAbsorbance.Visible = dual && (!hideAllFields && shutterOpen);
       this.channelBAULabel.Visible = dual && (!hideAllFields && isLampOn && shutterOpen);
       this.waveBoxB.Visible = !hideAllFields && dual;
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.resx	2014-12-19 19:33:42.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/CoreTUVStatusControl.resx	2013-07-25 10:14:46.000000000 -0400
@@ -162,21 +162,21 @@
   <data name="label2.Location" type="System.Drawing.Point, System.Drawing">
     <value>0, 0</value>
   </data>
   <data name="label2.Size" type="System.Drawing.Size, System.Drawing">
     <value>152, 39</value>
   </data>
   <data name="label2.TabIndex" type="System.Int32, mscorlib">
     <value>1</value>
   </data>
   <data name="label2.Text" xml:space="preserve">
-    <value>UV Detector</value>
+    <value>TUV Detector</value>
   </data>
   <data name="&gt;&gt;label2.Name" xml:space="preserve">
     <value>label2</value>
   </data>
   <data name="&gt;&gt;label2.Type" xml:space="preserve">
     <value>Waters.ACQUITY.ConsoleLabel, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
   <data name="&gt;&gt;label2.Parent" xml:space="preserve">
     <value>$this</value>
   </data>
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/TUVPreferences.resx C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/TUVPreferences.resx
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/ConsoleCoreTUV/TUVPreferences.resx	2015-01-14 16:29:54.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/ConsoleCoreTUV/TUVPreferences.resx	2010-05-04 00:47:30.000000000 -0400
@@ -567,19 +567,19 @@
   <metadata name="$this.Localizable" type="System.Boolean, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
   <data name="$this.ClientSize" type="System.Drawing.Size, System.Drawing">
     <value>370, 569</value>
   </data>
   <data name="$this.StartPosition" type="System.Windows.Forms.FormStartPosition, System.Windows.Forms">
     <value>CenterParent</value>
   </data>
   <data name="$this.Text" xml:space="preserve">
-    <value>UV Detector Preferences</value>
+    <value>TUV Preferences</value>
   </data>
   <data name="&gt;&gt;$this.Name" xml:space="preserve">
     <value>TUVPreferences</value>
   </data>
   <data name="&gt;&gt;$this.Type" xml:space="preserve">
     <value>Waters.ACQUITY.ConsoleForm, Waters.ACQUITY.Utilities, Version=1.50.0.0, Culture=neutral, PublicKeyToken=6c13fd0b3604de03</value>
   </data>
 </root>
\ No newline at end of file
Only in C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console: CoreTUVCom
Only in C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console: CoreTUVControl
Only in C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console: CoreTUVWebService
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Console/RemoteCoreTUV/RemoteCoreTUV.cs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/RemoteCoreTUV/RemoteCoreTUV.cs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Console/RemoteCoreTUV/RemoteCoreTUV.cs	2014-12-19 19:17:12.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Console/RemoteCoreTUV/RemoteCoreTUV.cs	2014-12-10 15:15:20.000000000 -0500
@@ -1880,21 +1880,21 @@
           return identityInfo.InstrumentType;
         else
           return string.Empty;
         }
       }

     #endregion

     #region IInstrumentBase2 Members

-    public string RoleID
+    public virtual string RoleID
       {
       set
         {
         roleID = value;
         }
       get
         {
         if (roleID == string.Empty)
           ApplyRole(RoleIndex + 1);

@@ -1945,21 +1945,21 @@
         roleCount = value;
         }
       get
         {
         return roleCount;
         }
       }

     public void ApplyRole(int roleNumber)
       {
-          RoleRoot = identityInfo.GetIdentityString("ChannelNamePrefix");
+      RoleRoot = "TUV";

       if (roleNumber <= 1)
         {
         RoleIndex = 0;
         RoleID = RoleRoot;
         }
       else
         {
         RoleIndex = roleNumber - 1;
         RoleID = string.Format("{0}-{1}", RoleRoot, roleNumber);
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.cpp C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.cpp
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.cpp	2014-10-17 13:32:10.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.cpp	2015-01-22 16:07:08.000000000 -0500
@@ -128,20 +128,32 @@
     }
   catch (...)
     {
     }

   if ( m_hWnd != NULL )
     UpdateData(FALSE);                              // out to the window
   m_dataLoaded = true;
   }

+// Additional validation to make sure min is always < max
+bool CAnalogOutPage::PostValidateFields()
+{
+  if (m_ratioScalingMin >= m_ratioScalingMax)
+  {
+    AlertUser();
+    return FALSE;
+  }
+
+  return TRUE;
+}
+
 // FUNCTION
 //
 /// <summary>StoreDataInDoc
 /// <para>Store the latest user changes into the XML document. Assumes that the
 /// UpdateData(TRUE) has been called.</para>
 /// </summary>
 //
 void CAnalogOutPage::StoreDataInDoc()
   {
   try
@@ -223,30 +235,49 @@
 /// <summary>OnKillActive
 /// </summary>
 //
 BOOL CAnalogOutPage::OnKillActive()
   {
   // Validate data only if the window still exists
   if (m_hWnd != NULL )
     {
     if( UpdateData(TRUE) )
       {
+    if (m_ratioScalingMin >= m_ratioScalingMax)
+    {
+      AlertUser();
+      return FALSE;
+    }
+
       StoreDataInDoc();
       return TRUE;
       }

     return FALSE;
     }
   else
     return TRUE;
   }

+void CAnalogOutPage::AlertUser()
+{
+  CString msg;
+  msg.LoadString(IDS_MINMAX);
+
+  CString caption;
+  caption.LoadString(IDS_WARNING);
+  MessageBox(msg, caption, MB_ICONWARNING);
+
+  m_ratioScalingMinCtrl.SetFocus();
+  m_ratioScalingMinCtrl.SetSel(0, -1);
+}
+
 // FUNCTION
 //
 /// <summary>OnSetActive
 /// </summary>
 //
 BOOL CAnalogOutPage::OnSetActive()
   {
   // If first time, load the data from the document
   if ( !m_dataLoaded )
     LoadDataFromDoc();
@@ -375,61 +406,63 @@
   PostMessage( WM_VALIDATEEDITBOX, IDC_PD_ANA_AUFS, (LPARAM)GetSafeHwnd() );
   }

 // FUNCTION
 //
 /// <summary>OnKillfocusPdAnaScalingMax
 /// </summary>
 //
 void CAnalogOutPage::OnKillfocusPdAnaScalingMax()
   {
-  PostMessage( WM_VALIDATEEDITBOX, IDC_PD_ANA_SCALING_MAX, (LPARAM)GetSafeHwnd() );
+  PostMessage( WM_VALIDATEEDITBOX, IDC_PD_ANA_SCALING_MAX, (LPARAM)GetSafeHwnd() );
   }

 // FUNCTION
 //
 /// <summary>OnKillfocusPdAnaScalingMin
 /// </summary>
 //
 void CAnalogOutPage::OnKillfocusPdAnaScalingMin()
   {
-  PostMessage( WM_VALIDATEEDITBOX, IDC_PD_ANA_SCALING_MIN, (LPARAM)GetSafeHwnd() );
+  PostMessage( WM_VALIDATEEDITBOX, IDC_PD_ANA_SCALING_MIN, (LPARAM)GetSafeHwnd() );
   }

 // FUNCTION
 //
 /// <summary>OnKillfocusPdAnaVoltageOffset
 /// </summary>
 //
 void CAnalogOutPage::OnKillfocusPdAnaVoltageOffset()
   {
   PostMessage( WM_VALIDATEEDITBOX, IDC_PD_ANA_VOLTAGE_OFFSET, (LPARAM)GetSafeHwnd() );
   }

 // FUNCTION
 //
 /// <summary>OnEnChange
 /// </summary>
 //
 void CAnalogOutPage::OnEnChange()
   {
-  GetParentDlg()->SetModified();
+  // basic validation against schema min/max
+      GetParentDlg()->SetModified();
   }

 // FUNCTION
 //
 /// <summary>OnCbnSelchangePdAnaPolarity
 /// </summary>
 //
 void CAnalogOutPage::OnCbnSelchangePdAnaPolarity()
   {
-  GetParentDlg()->SetModified();
+  // basic validation against schema min/max
+  GetParentDlg()->SetModified();
   }

 // FUNCTION
 //
 /// <summary>OnBnClickedPdAnaChartMarks
 /// </summary>
 //
 void CAnalogOutPage::OnBnClickedPdAnaChartMarks()
   {
   GetParentDlg()->SetModified();
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.h C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.h
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.h	2014-10-17 13:32:08.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/AnalogOutPage.h	2015-01-22 15:53:08.000000000 -0500
@@ -13,20 +13,22 @@

 //
 // CLASS: CAnalogOutPage
 //
 class CAnalogOutPage : public CEditorPropertyPage
   {
   // Construction
   public:
     CAnalogOutPage( CMethodEditDlg* pParent, int which, int idd = IDD_ANALOGOUT_PAGE );

+  bool PostValidateFields();
+
     // Take an XML document pointer
     CMethodEditDlg* GetParentDlg() {
       return (CMethodEditDlg*)m_parentDlg;
       }

     // Dialog Data
     //{{AFX_DATA(CAnalogOutPage)
     enum { IDD = IDD_ANALOGOUT_PAGE };
     CEdit m_ratioScalingMinCtrl;
     CEdit m_ratioScalingMaxCtrl;
@@ -47,20 +49,21 @@
   public:
     virtual BOOL OnKillActive();
     virtual BOOL OnSetActive();
     virtual void OnOK();
   protected:
     virtual void DoDataExchange(CDataExchange* pDX);        // DDX/DDV support
     //}}AFX_VIRTUAL

     // Implementation
   protected:
+  void AlertUser();

     // Generated message map functions
     //{{AFX_MSG(CAnalogOutPage)
     virtual BOOL OnInitDialog();
     afx_msg void OnKeysAltb();
     afx_msg void OnKillfocusPdAnaAbsOffset();
     afx_msg void OnKillfocusPdAnaAufs();
     afx_msg void OnKillfocusPdAnaScalingMax();
     afx_msg void OnKillfocusPdAnaScalingMin();
     afx_msg void OnKillfocusPdAnaVoltageOffset();
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgr.odl C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgr.odl
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgr.odl	2015-02-05 10:02:24.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgr.odl	2014-09-10 15:15:52.000000000 -0400
@@ -2,21 +2,21 @@

 // This file will be processed by the Make Type Library (mktyplib) tool to
 // produce the type library (AcquityTUVEditMgr.tlb) that will become a resource in
 // EditMgr ocx.

 #include <olectl.h>
 #include <idispids.h>
 #include "Identity.idl"

 [ uuid(GUID_LIBRARY_EDITOR), version(1.0),
-  helpstring("UV Method Editor Control"),
+  helpstring("Waters TUV Method Editor Control"),
   control ]
 library TUVEDITMGRLib
 {
   importlib(STDOLE_TLB);
   importlib(STDTYPE_TLB);
   importlib("..\..\..\..\Shared\InstrIDL\instrumentIfc.tlb");
   //  Primary dispatch interface

   [ uuid(GUID_INTERFACE_EDITOR),
     helpstring("Dispatch interface for TUVEditMgr Control"), hidden ]
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgrResource.h C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgrResource.h
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgrResource.h	2014-10-30 14:37:30.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/CoreTUVEditMgrResource.h	2015-01-22 14:52:56.000000000 -0500
@@ -95,20 +95,21 @@
 #define IDM_ABOUT                       2084
 #define IDR_DIALOGACCELS                2085
 #define IDS_ABOUT                       2086
 #define IDS_ABSORBANCE                  2087
 #define IDS_ABSORBANCE_CH               2088
 #define IDS_TUVEDITMGR                  2089
 #define IDS_TUVEDITMGR_PPG              2090
 #define IDS_TUVEDITMGR_PPG_CAPTION      2091
 #define IDS_CHANNEL_DESCRIPTION         2092
 #define IDS_COPYRIGHT_STRING            2093
+#define IDS_WARNING                     2093
 #define IDS_DUAL_TOOLTIP                2094
 #define IDS_ERROR_DUALWAVELENGTH        2095
 #define IDS_ERROR_TIMECONSTANT          2096
 #define IDS_EVENT_SWITCH1               2097
 #define IDS_EVENT_SWITCH2               2098
 #define IDS_EVENTHEADING_CHANNEL        2099
 #define IDS_EVENTHEADING_PARAMETER      2100
 #define IDS_EVENTHEADING_TIME           2101
 #define IDS_FILTERSPEED_TOOLTIP         2102
 #define IDS_FONT_NAME_TAHOMA            2103
@@ -116,20 +117,21 @@
 #define IDS_INVALID_PARAMETER1          2105
 #define IDS_INVALID_PARAMETER2          2106
 #define IDS_NONE                        2107
 #define IDS_NOPROMPT                    2108
 #define IDS_PD_ANALOGTITLE              2109
 #define IDS_PD_CHANNELTITLE             2110
 #define IDS_PD_DEFAULTMETHODNAME        2111
 #define IDS_PD_EV_EVENT_LABEL           2112
 #define IDS_PD_METHODEDIT_TITLE         2113
 #define IDS_PRODUCT_STRING              2114
+#define IDS_MINMAX                      2114
 #define IDS_SINGLE_TOOLTIP              2115
 #define IDS_TIME_MIN                    2116
 #define IDS_VERSION_STRING              2117
 #define IDS_WARNING1                    2118
 #define IDS_WARNING_EVENTSAFTERRUNTIME  2119
 #define IDS_WARNING_SECONDORDER         2120
 #define IDS_ABSORBANCE_MBF              2121
 #define IDS_ABSORBANCE_CH_MBF           2122
 #define IDC_CHAN2_UNIT                  2123
 #define IDS_EVENT_OUT_CH_A              2124
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/MethodEditDlg.cpp C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/MethodEditDlg.cpp
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/MethodEditDlg.cpp	2014-12-23 13:28:32.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVEditMgr/MethodEditDlg.cpp	2015-01-22 10:44:46.000000000 -0500
@@ -82,20 +82,29 @@
     supportsTempControl        = c.supportsTempControl;
     supportsLampMemDevice      = c.supportsLampMemDevice;
     supportsFlowCellMemDevice  = c.supportsFlowCellMemDevice;
     supportsCoolerHardware     = c.supportsCoolerHardware;
     }
   else
     {
     // MassLynx doesn't pass in the config
     EthernetScan escan( Identity::GetIdentity()->m_instrType );
     CString configurationName = escan.GetID();
+
+  // Get config from registry; saved to registry in CoreTUVInstrObject using data in XXXX-Config-Current.xml
+  CString key;
+  key.Format(_T("%s\\%s\\Configurations\\%s"), SOFTWAREROOT_KEYNAME, Identity::GetIdentity()->m_instrType, configurationName); // NOTRANSLATE
+  supportsReducedIO          = (int)atoi(GetRegistryString( key, _T("SupportsReducedIO"),  CString() )); // NOTRANSLATE
+  supportsTempControl        = (int)atoi(GetRegistryString( key, _T("SupportsTempControl"),  CString() )); // NOTRANSLATE
+  supportsLampMemDevice      = (int)atoi(GetRegistryString( key, _T("SupportsLampMemDevice"),  CString() )); // NOTRANSLATE
+  supportsFlowCellMemDevice  = (int)atoi(GetRegistryString( key, _T("SupportsFlowCellMemDevice"),  CString() )); // NOTRANSLATE
+  supportsCoolerHardware     = (int)atoi(GetRegistryString( key, _T("SupportsCoolerHardware"),  CString() )); // NOTRANSLATE
     }

   // Auto-create
   if ( m_bInContainer )
     {
     Create(CMethodEditDlg::IDDCNTR, pParent);
     GetDlgItem(IDOK)->ShowWindow( SW_HIDE );
     GetDlgItem(IDCANCEL)->ShowWindow( SW_HIDE );
     }
   else
@@ -698,21 +707,21 @@
   delete m_pAnalogOutAPage;
   delete m_pAnalogOutBPage;
   delete m_pEventPage;

   m_pChan1Page = 0;
   m_pChan2Page = 0;
   m_pAnalogOutAPage = 0;
   m_pAnalogOutBPage = 0;
   m_pEventPage = 0;

-  bool isW2489 = Identity::GetIdentity()->m_instrType == "A10-UV";
+  bool isW2489 = Identity::GetIdentity()->m_instrType == "W2489";

   int idd = (isW2489) ? IDD_CHANNEL_PAGE1 : IDD_CHANNEL_PAGE;
   m_pChan1Page = new CChannelPage( this, 0, 0, idd);
     m_pPropertySheet->AddPage( m_pChan1Page );

     m_pChan2Page = new CChannelPage( this, 0, 1, idd );
     if( pTUV->wavelengthMode == 2 )
        m_pPropertySheet->AddPage( m_pChan2Page );

   idd = (isW2489) ? IDD_ANALOGOUT_PAGE1 : IDD_ANALOGOUT_PAGE;
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstr.idl C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstr.idl
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstr.idl	2010-03-23 14:13:42.000000000 -0400
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstr.idl	2015-01-20 11:12:02.000000000 -0500
@@ -113,21 +113,21 @@

   [helpstring("ChangeLamp: Sets the install date and serial num of the new lamp")]
   HRESULT ChangeLamp([in]BSTR * serialNumber, [in]float month, [in]float day,[in]float year);

     [helpstring("SetSerialNumber: Set serial number")]
   HRESULT SetSerialNumber([in]BSTR serialNumber);

   [helpstring("VisualID: Activates the visual identification mode")]
     HRESULT VisualID([in]int seconds);

-  [helpstring("CancelAutoZero: Sets auto zero offset to 0 on channel (0=A, 1=B)")]
+  [helpstring("CancelAutoZero: Sets autozero offset to 0 on channel (0=A, 1=B)")]
     HRESULT CancelAutoZero([in]int channel);

   [helpstring("ResetNVRam: Resets NVRam to defaults")]
     HRESULT ResetNVRam();

   [helpstring("SetLeakDetectConfig:  Enable or disable the leak detector.")]
     HRESULT SetLeakDetectConfig( [in]boolean enable, int index);

   [helpstring("SetFilterPosition: Set the filter position (0=None, 1=Order, 2=Erbium, 3=Shutter, 4=Auto")]
     HRESULT SetFilterPosition([in]int filterPosition );
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrComms.cpp C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrComms.cpp
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrComms.cpp	2014-12-11 17:53:24.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrComms.cpp	2013-04-02 09:57:08.000000000 -0400
@@ -423,22 +423,21 @@
 bool CCoreTUVInstrComms::AcquireInstrumentStatus()
 {
     bool ret = false;

     try
     {
         //CoreTUVInstrStatusDetail *pStatus = static_cast<CoreTUVInstrStatusDetail *>(CurrentStatus());

       CInstrumentStatusLock status(this);
       STATUSCLASS* pStatus = static_cast<STATUSCLASS*>(status.CurrentStatus());
-    if( pStatus != NULL )
-    {
+
         //Uint8 lastStatus = pStatus->CoreTUVStatus.dataMode;

         ret = CInstrument::AcquireInstrumentStatus();

     if( HasFakeAlarm() )
       ++pStatus->CoreTUVStatus.ComStatus.alarmCount;

         if (ret )
         {
             //if( pStatus->HaveErrors() )
@@ -466,21 +465,20 @@
             case ctrl_IDLE_DATA:
             case ctrl_ERROR_MODE:
                 break;

             default:
                 SetConnectionState( CConnection::Disconnected );
                 break;
             }
             DiagnosticLog( DiagLevelD, _T("Status"), _T("Current mode is %s"), theMode );
         }
-    }
     }
     catch(...)
     {
     }

     return ret;
 }

 // FUNCTION
 //
@@ -551,22 +549,20 @@
   bool fakeAlarm = HasFakeAlarm();
     ret = CDetectorInstrument::GetAlarm();

     if( ret )
     {
         //CoreTUVInstrStatusDetail *pStatus = static_cast<CoreTUVInstrStatusDetail *>(CurrentStatus());

     CInstrumentStatusLock status(this);
     STATUSCLASS* pStatus = static_cast<STATUSCLASS*>(status.CurrentStatus());

-  if( pStatus != NULL )
-  {
         WatersXmlEnum* pNextAlarm = &pStatus->m_xml.ledAlarm.type;
         CCoreTUVInstrAlarmData* pAlarm = static_cast<CCoreTUVInstrAlarmData*>(CurrentAlarm());

         // Assign alarm ID into WatersXmlEnum to look up localized text
     bool temp = WatersXmlVariable::OptimizeAssignments;
     WatersXmlVariable::OptimizeAssignments = false;
         *pNextAlarm = pAlarm->Type();
     WatersXmlVariable::OptimizeAssignments = temp;

         CString rawText = pAlarm->NativeText();
@@ -593,56 +589,49 @@

                 nativeString.Append( _T(" ") );
                 nativeString.Append( suffix );
             }
         }

         pAlarm->SetText( localizedString, nativeString );

     if( fakeAlarm && pAlarm->Type() > 0 )
       SetAlarm( pAlarm->Type(), pAlarm->Text(), pAlarm->NativeText() );
-  }
     }
     return ret;
 }

 void CCoreTUVInstrComms::SetAlarm( int alarmType, LPCSTR alarmText, LPCSTR nativeText )
 {
   SetAlarmState(true);

   CInstrumentStatusLock status(this);
   STATUSCLASS* pStatus = static_cast<STATUSCLASS*>(status.CurrentStatus());
-  if( pStatus != NULL )
-  {
-    WatersXmlDocument* pDoc = &pStatus->m_xml;
-    CInstrument::SetAlarm( pDoc, alarmType, alarmText, nativeText );
-  }
+  WatersXmlDocument* pDoc = &pStatus->m_xml;
+  CInstrument::SetAlarm( pDoc, alarmType, alarmText, nativeText );
 }

 bool CCoreTUVInstrComms::GetAlarmState()
 {
   CInstrumentStatusLock status(this);
   STATUSCLASS* pStatus = static_cast<STATUSCLASS*>(status.CurrentStatus());

-  return ( pStatus != NULL && pStatus->CoreTUVStatus.ComStatus.state == ComRmtStatus::Error );
+  return ( pStatus->CoreTUVStatus.ComStatus.state == ComRmtStatus::Error );
 }

 void CCoreTUVInstrComms::SetAlarmState( bool sw )
 {
   CInstrumentStatusLock status(this);
   STATUSCLASS* pStatus = static_cast<STATUSCLASS*>(status.CurrentStatus());

-  if( pStatus != NULL )
+  if( sw )
   {
-    if( sw )
-    {
-      pStatus->CoreTUVStatus.ComStatus.state = ComRmtStatus::Error;
-      pStatus->CoreTUVStatus.ComStatus.ledState = ComRmtStatus::FlashingRed;
-    }
-    else
-      pStatus->CoreTUVStatus.ComStatus.state = ComRmtStatus::Idle;
+    pStatus->CoreTUVStatus.ComStatus.state = ComRmtStatus::Error;
+    pStatus->CoreTUVStatus.ComStatus.ledState = ComRmtStatus::FlashingRed;
   }
+  else
+    pStatus->CoreTUVStatus.ComStatus.state = ComRmtStatus::Idle;
 }

 //
 // END OF CoreTUVInstrComms.cpp
 //
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrObject.cpp C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrObject.cpp
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrObject.cpp	2015-02-02 11:38:04.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVInstr/CoreTUVInstrObject.cpp	2015-01-22 10:35:20.000000000 -0500
@@ -599,20 +599,32 @@
       pConfig->GenerateBriefCompressedXML(configurationXML, pConfig->GetDomPtr());
     else
       pConfig->GenerateCompressedXML(configurationXML, pConfig->GetDomPtr());

     SaveConfig(m_lastConfigXml );

     // Save XML to disk when diagnostics are enabled
     if( GetDiagnosticLevel() >= DiagLevelC )
       SaveConfig(m_lastConfigXml, 10 );

+  // Write Config info to registry for MassLynx to use
+  CString instrType = Identity::GetIdentity()->m_instrType;
+  CString keyname;
+  keyname.Format( _T("Software\\Waters\\Instruments\\%s\\Configurations\\%s"), instrType, m_configKey ); // NOTRANSLATE
+  SetRegistryString( keyname, _T("DetectorType"), instrType ); // NOTRANSLATE
+
+  SetRegistryInt( keyname, _T("SupportsReducedIO"), (pXML->supportsReducedIO ? 1 : 0) );
+  SetRegistryInt( keyname, _T("SupportsTempControl"), (pXML->supportsTempControl ? 1 : 0) );
+  SetRegistryInt( keyname, _T("SupportsLampMemDevice"), (pXML->supportsLampMemDevice ? 1 : 0) );
+  SetRegistryInt( keyname, _T("SupportsFlowCellMemDevice"), (pXML->supportsFlowCellMemDevice ? 1 : 0) );
+  SetRegistryInt( keyname, _T("SupportsCoolerHardware"), (pXML->supportsCoolerHardware ? 1 : 0) );
+
     return true;
     }

   catch(...)
     {
     DiagnosticLog( DiagLevelD, _T("Configuration"), _T("Exception in GetConfigurationAsXML().") );
     }
   return false;
   }

@@ -1012,21 +1024,20 @@
     {
     PerformanceLog( "TIMEOUT", "Error in CoreTUVInstrObject::__Identify(), %s", m_configurationName );
     return;
     }

   m_configKey = m_configurationName;

   //RunTimeInMethod should persist if it is ever set.
   m_opts = desiredOptions | (m_opts & InstrClient_RunTimeInMethod);

-  LaunchConsole(FALSE);
   GetClientBuffer();

   CInstrument* pInstrument = m_pInstrument;

   SetUp();

   if ( IsMasslynx() && (desiredOptions & InstrClient_ResetComms) )
     {
     DiagnosticLog( DiagLevelD, diagCategory, _T("Instrument()->ResetInstrument() called from Identify()") );

@@ -1041,20 +1052,22 @@
   if( bCreateThread )
     m_system.Setup( m_configKey, m_opts, !IsEmpower(true) );
   else
     m_system.SetOptions( m_opts );

 #ifdef STATUS_THREAD
   if (bCreateThread && m_hStatusThread == 0)
     CreateStatusThread();
 #endif

+  LaunchConsole(FALSE);
+
   CComBSTR configurationXML = __GetConfiguration();

   // supportsReducedIO==true indicates a TUV vintage that supports lamp memory device.
   if (CurrentConfig()->pXML()->supportsReducedIO)
     {
     // Set the instrument's clock time...
     SYSTEMTIME systemTime;
     GetLocalTime(&systemTime);

     tm tmTime;
@@ -1997,27 +2010,20 @@
 //
 /// <summary>__SetSystemComponents
 /// </summary>
 //
 void CoreTUVInstrObject::__SetSystemComponents(BSTR systemName, BSTR acquisitionNodeName, int count, BSTR* components)
   {
   CString cSystemName(systemName);
   SetSystemName( cSystemName );

   m_system.SetComponents( count, components );
-
-  if ( !m_system.IsValidSystem() )
-  {
-    CString msg = pID->GetXMLResources()->Enumeration( _T("tAlarmType"), _T("ICSAlarmInvalidSystem_3004") );
-    CString nativeMsg = "Invalid system configuration";
-    SetClientAlarm( 3004, ComRmtAlarm::Error, msg, nativeMsg );
-  }
   }

 // FUNCTION
 //
 /// <summary>__SetContext
 /// </summary>
 //
 void CoreTUVInstrObject::__SetContext(BSTR context)
   {
   SetContext( context );
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVResENU/CoreTUVEditMgr.rc C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVResENU/CoreTUVEditMgr.rc
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVResENU/CoreTUVEditMgr.rc	2015-01-14 16:41:22.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVResENU/CoreTUVEditMgr.rc	2015-02-24 14:02:52.000000000 -0500
@@ -105,26 +105,26 @@
     LTEXT           "points/sec",IDC_STATIC,41,65,45,8
     LTEXT           "Filter Time Constant:",IDC_STATIC,7,86,65,8
     COMBOBOX        IDC_FILTERSPEED,7,97,48,69,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     EDITTEXT        IDC_TIMECONSTANT,62,97,33,12,ES_AUTOHSCROLL
     LTEXT           "sec",IDC_STATIC,98,99,16,8
     LTEXT           "Data Mode:",IDC_STATIC,136,18,51,8
     COMBOBOX        IDC_PD_CHAN_DATAMODE,136,28,87,112,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     LTEXT           "Absorbance Minimum:",IDC_RATIOMIN_LABEL,236,18,98,8
     EDITTEXT        IDC_PD_CHAN_RATIOMIN,236,28,76,12,ES_AUTOHSCROLL | WS_GROUP
     LTEXT           "AU",IDC_RATIOMIN_UNITS,317,30,17,8
-    CONTROL         "Auto Zero On Inject Start",IDC_PD_CHAN_AUTOZERO_INJECT,
+    CONTROL         "Autozero On Inject Start",IDC_PD_CHAN_AUTOZERO_INJECT,
                     "Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,136,63,133,10
     LTEXT           "Comment:",IDC_STATIC,6,147,38,8,NOT WS_GROUP
     EDITTEXT        IDC_PD_CHAN_DESCRIPTION,6,157,194,12,ES_AUTOHSCROLL
     PUSHBUTTON      "...",IDC_ELLIPSIS,201,157,12,12
-    LTEXT           "Auto Zero On Wavelength Changes:",IDC_STATIC,136,86,121,8
+    LTEXT           "Autozero On Wavelength Changes:",IDC_STATIC,136,86,121,8
     COMBOBOX        IDC_AUTOZEROWAVELENGTH,136,97,80,64,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP
     PUSHBUTTON      "?",IDC_HELPBUTTON,318,2,16,12,BS_ICON
 END

 IDD_ANALOGOUT_PAGE DIALOGEX 0, 0, 340, 184
 STYLE DS_SETFONT | DS_3DLOOK | DS_NOFAILCREATE | DS_CONTROL | WS_CHILD | WS_VISIBLE | WS_CAPTION
 EXSTYLE WS_EX_CONTROLPARENT
 FONT 8, "MS Sans Serif", 0, 0, 0x1
 BEGIN
     LTEXT           "Sensitivity:",IDC_PD_ANA_AUFS_LABEL,20,12,55,8
@@ -147,25 +147,25 @@
 END

 IDD_EVENT_PAGE DIALOGEX 0, 0, 316, 184
 STYLE DS_SETFONT | DS_3DLOOK | DS_NOFAILCREATE | DS_CONTROL | WS_CHILD | WS_VISIBLE | WS_CAPTION
 EXSTYLE WS_EX_CONTROLPARENT
 CAPTION "Events"
 FONT 8, "MS Sans Serif", 0, 0, 0x1
 BEGIN
     GROUPBOX        "Threshold Events",IDC_THRESHOLD_GROUP,3,2,182,58
     LTEXT           "Threshold:",IDC_THRESHOLD_ABOVE_LABEL,124,8,45,8
-    CONTROL         "Switch 1 (Channel A)",IDC_PD_EV_CHAN1_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,10,18,56,16
+    CONTROL         "Event Out (Channel A)",IDC_PD_EV_CHAN1_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,10,18,56,16
     COMBOBOX        IDC_PD_EV_CHAN1_FUNCTION,70,19,50,68,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     EDITTEXT        IDC_PD_EV_CHAN1_THRESHOLD,124,19,40,12,ES_AUTOHSCROLL | WS_GROUP
     LTEXT           "AU",IDC_STATIC,168,22,11,8
-    CONTROL         "Switch 2 (Channel B)",IDC_PD_EV_CHAN2_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,10,38,56,16
+    CONTROL         "Event Out (Channel B)",IDC_PD_EV_CHAN2_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,10,38,56,16
     COMBOBOX        IDC_PD_EV_CHAN2_FUNCTION,70,40,50,78,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     EDITTEXT        IDC_PD_EV_CHAN2_THRESHOLD,124,40,40,12,ES_AUTOHSCROLL | WS_GROUP
     LTEXT           "AU",IDC_CHAN2_UNIT,168,42,11,8
     GROUPBOX        "Output Switch Timing",IDC_SWITCHTIMING_GROUP,192,2,124,58
     LTEXT           "Rect Wave Period (50% duty cycle):",IDC_RECTWAVE_LABEL,195,20,62,18
     EDITTEXT        IDC_PD_EV_REPEAT_PULSE,196,40,30,12,ES_AUTOHSCROLL | WS_GROUP
     LTEXT           "sec",IDC_RECTWAVE_UNITS,227,42,18,8
     LTEXT           "Pulse Width:",IDC_PULSE_LABEL,266,20,34,18
     EDITTEXT        IDC_PD_EV_PULSE,266,40,30,12,ES_AUTOHSCROLL | WS_GROUP
     LTEXT           "sec",IDC_PULSE_UNITS,298,41,14,8
@@ -183,29 +183,29 @@
     GROUPBOX        "These are inactive in the contained editor",IDC_STATIC,145,98,155,91,NOT WS_VISIBLE
     LTEXT           "Waters 2487",IDC_MODULENAME_LABEL,163,113,94,15,NOT WS_VISIBLE | NOT WS_GROUP
     DEFPUSHBUTTON   "OK",IDOK,169,161,50,14,NOT WS_VISIBLE | WS_DISABLED | NOT WS_TABSTOP
     PUSHBUTTON      "Cancel",IDCANCEL,229,161,50,14,NOT WS_VISIBLE | WS_DISABLED | NOT WS_TABSTOP
     GROUPBOX        "Static",IDC_MODEBASE,0,307,396,30,NOT WS_VISIBLE
     CONTROL         "Single",IDC_PD_WL_SINGLE,"Button",BS_AUTORADIOBUTTON | BS_BOTTOM | WS_GROUP | WS_TABSTOP,15,320,36,10,WS_EX_TRANSPARENT
     CONTROL         "Dual",IDC_PD_WL_DUAL,"Button",BS_AUTORADIOBUTTON | BS_BOTTOM | WS_TABSTOP,62,321,36,10,WS_EX_TRANSPARENT
     LTEXT           "R&un Time:",IDC_RUNTIME_LABEL,228,322,34,8,NOT WS_VISIBLE | NOT WS_GROUP
     EDITTEXT        IDC_RUNTIME,266,320,40,12,ES_AUTOHSCROLL | NOT WS_VISIBLE
     LTEXT           "min",IDC_RUNTIME_UNITS,310,322,15,8,NOT WS_VISIBLE | NOT WS_GROUP
-    LTEXT           "UV Detector",IDC_MODULENAME,3,0,124,22
+    LTEXT           "TUV Detector",IDC_MODULENAME,3,0,124,22
 END

 IDD_METHODEDIT DIALOGEX 0, 0, 341, 257
 STYLE DS_SETFONT | DS_MODALFRAME | DS_SETFOREGROUND | DS_3DLOOK | DS_CENTER | WS_POPUP | WS_VISIBLE | WS_CAPTION | WS_SYSMENU
 EXSTYLE WS_EX_NOPARENTNOTIFY | WS_EX_CONTROLPARENT
 FONT 8, "MS Sans Serif", 0, 0, 0x1
 BEGIN
-    LTEXT           "UV Detector",IDC_MODULENAME,3,2,168,22
+    LTEXT           "TUV Detector",IDC_MODULENAME,3,2,168,22
     LTEXT           "Run Time:",IDC_RUNTIME_LABEL,241,7,34,8
     EDITTEXT        IDC_RUNTIME,278,5,40,12,ES_AUTOHSCROLL
     LTEXT           "min",IDC_RUNTIME_UNITS,323,7,15,8
     PUSHBUTTON      "&OK",IDOK,227,234,50,14,WS_GROUP | NOT WS_TABSTOP
     PUSHBUTTON      "Cancel",IDCANCEL,282,234,50,14,WS_GROUP | NOT WS_TABSTOP
     GROUPBOX        "placeholder",IDC_PROPBASE,3,23,335,205,NOT WS_VISIBLE
     DEFPUSHBUTTON   "Invisible",IDC_DEFAULTBUTTON,166,234,50,14,NOT WS_VISIBLE
     GROUPBOX        "Static",IDC_MODEBASE,3,196,29,20,NOT WS_VISIBLE
     CONTROL         "Modified",IDC_MODIFIED,"Button",BS_AUTOCHECKBOX | NOT WS_VISIBLE | WS_TABSTOP,3,239,43,10
 END
@@ -258,71 +258,71 @@
 END

 IDD_CHANNEL_PAGE1 DIALOGEX 0, 0, 320, 184
 STYLE DS_SETFONT | DS_3DLOOK | DS_NOFAILCREATE | DS_CONTROL | WS_CHILD | WS_VISIBLE | WS_CAPTION
 EXSTYLE WS_EX_CONTROLPARENT
 FONT 8, "MS Sans Serif", 0, 0, 0x1
 BEGIN
     CONTROL         "On",IDC_LAMP,"Button",BS_AUTOCHECKBOX | WS_GROUP | WS_TABSTOP,104,8,37,10
     EDITTEXT        IDC_PD_WAVELENGTH,104,21,25,12,ES_AUTOHSCROLL | WS_GROUP
     COMBOBOX        IDC_PD_CHAN_DATARATE,104,37,32,91,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
-    COMBOBOX        IDC_FILTERSPEED,104,54,48,69,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
-    EDITTEXT        IDC_TIMECONSTANT,157,55,33,12,ES_AUTOHSCROLL
+    COMBOBOX        IDC_FILTERSPEED,104,54,93,69,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
+    EDITTEXT        IDC_TIMECONSTANT,203,55,52,12,ES_AUTOHSCROLL
     COMBOBOX        IDC_AUTOZEROWAVELENGTH,104,84,80,64,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP
-    CONTROL         "Auto Zero",IDC_PD_CHAN_AUTOZERO_INJECT,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,104,102,72,10
-    COMBOBOX        IDC_PD_CHAN_DATAMODE,104,116,87,112,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
+    CONTROL         "Autozero",IDC_PD_CHAN_AUTOZERO_INJECT,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,104,102,72,10
+    COMBOBOX        IDC_PD_CHAN_DATAMODE,104,116,93,112,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     EDITTEXT        IDC_PD_CHAN_RATIOMIN,104,133,46,12,ES_AUTOHSCROLL | WS_GROUP
     EDITTEXT        IDC_PD_CHAN_DESCRIPTION,104,168,192,12,ES_AUTOHSCROLL
     PUSHBUTTON      "...",IDC_ELLIPSIS,300,167,16,12
     PUSHBUTTON      "?",IDC_HELPBUTTON,300,4,16,12,BS_ICON
     LTEXT           "Wavelength:",IDC_STATIC,4,23,100,8
     LTEXT           "nm",IDC_STATIC,133,23,21,8
     LTEXT           "Sampling rate:",IDC_STATIC,4,39,100,8
-    LTEXT           "points/sec",IDC_STATIC,140,39,45,8
+    LTEXT           "points/sec",IDC_STATIC,138,39,45,8
     LTEXT           "Filter time constant:",IDC_STATIC,4,56,100,8
-    LTEXT           "sec",IDC_STATIC,194,56,16,8
+    LTEXT           "sec",IDC_STATIC,263,56,16,8
     LTEXT           "Data mode:",IDC_STATIC,4,119,100,8
     LTEXT           "Absorbance minimum:",IDC_RATIOMIN_LABEL,4,135,100,8
     LTEXT           "AU",IDC_RATIOMIN_UNITS,153,135,17,8
     LTEXT           "Comment:",IDC_STATIC,4,170,38,8,NOT WS_GROUP
     LTEXT           "On wavelength changes:",IDC_STATIC,4,86,100,8
     CONTROL         "",IDC_STATIC,"Static",SS_BLACKFRAME | SS_SUNKEN,4,71,312,1
     LTEXT           "Lamp:",IDC_STATIC,4,8,100,8
     LTEXT           "On inject start:",IDC_STATIC,4,102,100,8
-    LTEXT           "Auto Zero mode",IDC_STATIC,104,75,78,8
+    LTEXT           "Autozero mode",IDC_STATIC,104,75,78,8
 END

 IDD_EVENT_PAGE2 DIALOGEX 0, 0, 320, 184
 STYLE DS_SETFONT | DS_3DLOOK | DS_NOFAILCREATE | DS_CONTROL | WS_CHILD | WS_VISIBLE | WS_CAPTION
 EXSTYLE WS_EX_CONTROLPARENT
 CAPTION "Events"
 FONT 8, "MS Sans Serif", 0, 0, 0x1
 BEGIN
-    CONTROL         "Switch 1 (Channel A)",IDC_PD_EV_CHAN1_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,84,17,90,8
+    CONTROL         "Event Out (Channel A)",IDC_PD_EV_CHAN1_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,84,17,90,8
     COMBOBOX        IDC_PD_EV_CHAN1_FUNCTION,174,15,50,68,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     EDITTEXT        IDC_PD_EV_CHAN1_THRESHOLD,229,15,40,12,ES_AUTOHSCROLL | WS_GROUP
-    CONTROL         "Switch 2 (Channel B)",IDC_PD_EV_CHAN2_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,84,35,90,8
+    CONTROL         "Event Out (Channel B)",IDC_PD_EV_CHAN2_ENABLE,"Button",BS_AUTOCHECKBOX | BS_MULTILINE | WS_GROUP | WS_TABSTOP,84,35,90,8
     COMBOBOX        IDC_PD_EV_CHAN2_FUNCTION,174,32,50,78,CBS_DROPDOWNLIST | WS_VSCROLL | WS_GROUP | WS_TABSTOP
     EDITTEXT        IDC_PD_EV_CHAN2_THRESHOLD,229,33,40,12,ES_AUTOHSCROLL | WS_GROUP
     EDITTEXT        IDC_PD_EV_PULSE,84,55,30,12,ES_AUTOHSCROLL | WS_GROUP
     EDITTEXT        IDC_PD_EV_REPEAT_PULSE,84,71,30,12,ES_AUTOHSCROLL | WS_GROUP
     CONTROL         "Enable",IDC_RUNEVENTS,"Button",BS_AUTOCHECKBOX | WS_GROUP | WS_TABSTOP,84,91,74,10
     CONTROL         "Custom1",IDC_TUV_EV_GRIDBASE,"GXWND",WS_BORDER | WS_VSCROLL,4,103,256,77
     PUSHBUTTON      "?",IDC_HELPBUTTON,300,4,16,12,BS_ICON
     LTEXT           "Threshold",IDC_THRESHOLD_ABOVE_LABEL,229,6,45,8
     LTEXT           "AU",IDC_STATIC,273,17,11,8
     LTEXT           "AU",IDC_CHAN2_UNIT,273,35,11,8
     LTEXT           "Rect wave period:",IDC_RECTWAVE_LABEL,4,72,80,8
     LTEXT           "sec",IDC_RECTWAVE_UNITS,117,72,18,8
     LTEXT           "Pulse width:",IDC_PULSE_LABEL,4,56,80,8
     LTEXT           "sec",IDC_PULSE_UNITS,117,56,14,8
-    LTEXT           "Function",IDC_THRESHOLD_ABOVE_LABEL2,175,6,45,8
+    RTEXT           "Initial switch state",IDC_THRESHOLD_ABOVE_LABEL2,147,6,73,8
     CONTROL         "",IDC_STATIC,"Static",SS_BLACKFRAME | SS_SUNKEN,4,50,308,1
     CONTROL         "",IDC_STATIC,"Static",SS_BLACKFRAME | SS_SUNKEN,4,87,308,1
     LTEXT           "Switch events:",IDC_STATIC,4,17,80,8
     LTEXT           "Run events:",IDC_STATIC,4,91,80,8
     LTEXT           "(50% duty cycle)",IDC_RECTWAVE_LABEL2,134,72,80,8
 END


 /////////////////////////////////////////////////////////////////////////////
 //
@@ -384,20 +384,21 @@
         VERTGUIDE, 90
         TOPMARGIN, 4
         BOTTOMMARGIN, 180
     END

     IDD_CHANNEL_PAGE1, DIALOG
     BEGIN
         LEFTMARGIN, 4
         RIGHTMARGIN, 316
         VERTGUIDE, 104
+        VERTGUIDE, 183
         TOPMARGIN, 4
         BOTTOMMARGIN, 180
     END

     IDD_EVENT_PAGE2, DIALOG
     BEGIN
         LEFTMARGIN, 4
         RIGHTMARGIN, 316
         VERTGUIDE, 84
         TOPMARGIN, 4
@@ -482,27 +483,28 @@
 END


 /////////////////////////////////////////////////////////////////////////////
 //
 // String Table
 //

 STRINGTABLE
 BEGIN
-    IDS_ABOUT               "About UV Detector..."
+    IDS_ABOUT               "About TUV Detector..."
     IDS_ABSORBANCE          "Absorbance"
     IDS_ABSORBANCE_CH       "Absorbance %c"
-    IDS_TUVEDITMGR          "UV Detector Method Editor"
-    IDS_TUVEDITMGR_PPG      "UV Detector Edit Manager Property Page"
+    IDS_TUVEDITMGR          "TUV Detector Method Editor"
+    IDS_TUVEDITMGR_PPG      "TUV Detector Edit Manager Property Page"
     IDS_TUVEDITMGR_PPG_CAPTION "General"
     IDS_CHANNEL_DESCRIPTION "Channel %c Description"
+    IDS_WARNING             "Warning"
     IDS_DUAL_TOOLTIP        "Dual wavelength mode"
     IDS_ERROR_DUALWAVELENGTH
                             "Dual wavelength mode requires two different wavelengths"
 END

 STRINGTABLE
 BEGIN
     IDS_ERROR_TIMECONSTANT  "Time constant is out of range on channel %c.\n\nLimits are %0.*f-%0.*f sec in single wavelength\nor %0.*f-%0.*f sec in dual wavelength mode."
     IDS_EVENT_SWITCH1       "Switch 1"
     IDS_EVENT_SWITCH2       "Switch 2"
@@ -518,20 +520,21 @@
     IDS_NOPROMPT            "NO PROMPT"
     IDS_PD_ANALOGTITLE      "Analog Out %c"
     IDS_PD_CHANNELTITLE     "Channel %c"
     IDS_PD_DEFAULTMETHODNAME "Method2487"
 END

 STRINGTABLE
 BEGIN
     IDS_PD_EV_EVENT_LABEL   "Event"
     IDS_PD_METHODEDIT_TITLE "Modify %s Instrument Method"
+    IDS_MINMAX              "Minimum value must be less than the maximum value"
     IDS_SINGLE_TOOLTIP      "Single wavelength mode"
     IDS_TIME_MIN            "Time\n(min)"
     IDS_WARNING1            "%s on row %d is not a valid number."
     IDS_WARNING_EVENTSAFTERRUNTIME
                             "One or more timed events are scheduled\nto occur after the end of run time.\n\nSave anyway?"
     IDS_WARNING_SECONDORDER "The wavelengths span 370 nm.\nThe second order filter will not be used for %d nm.\n\nAny data collected at %d nm may contain inaccuracies\nbecause of possible UV interference (second order effects)."
     IDS_ABSORBANCE_MBF      "Absorbance -MBF"
     IDS_ABSORBANCE_CH_MBF   "Absorbance %c -MBF"
     IDS_EVENT_OUT_CH_A      "Event Out (Channel A)"
 END
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.h C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.h
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.h	2014-11-11 17:29:32.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.h	2013-01-16 15:28:00.000000000 -0500
@@ -235,14 +235,14 @@

     EthernetScanHelper* pTuvEscan;

     void ReleaseInstrument();
     void    InitClassInstance(void);
     bool IsClassInited() {
         return ( m_pInstrImpl != 0 );
     }
 };

-OBJECT_ENTRY_AUTO(__uuidof(SERVERCOCLASS), CCoreTUVServer)
+OBJECT_ENTRY_AUTO(__uuidof(TUVServer), CCoreTUVServer)
 //
 // END OF CoreTUVServerCoClass.h
 //
diff --recursive --expand-tabs --tabsize=2 --unified=10 C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.rgs C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.rgs
--- C:\Q\ICS\Instruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.rgs	2015-01-30 18:53:26.000000000 -0500
+++ C:\Q\ICS\FirstPartyInstruments\TUV\CoreTUV/Driver/CoreTUVServer/CoreTUVServerCoClass.rgs	2009-04-15 13:00:04.000000000 -0400
@@ -1,24 +1,24 @@
 HKCR
 {
-  $Company$.$FilenameRoot$Server.1 = s '$Company$ $FilenameRoot$Server Class'
+  Waters.$FilenameRoot$Server.1 = s 'Waters $FilenameRoot$Server Class'
   {
     CLSID = s '$ProxyCLSID$'
   }
-  $Company$.$FilenameRoot$Server = s '$Company$ $FilenameRoot$Server Class'
+  Waters.$FilenameRoot$Server = s 'Waters $FilenameRoot$Server Class'
   {
     CLSID = s '$ProxyCLSID$'
-    CurVer = s '$Company$.$FilenameRoot$Server.1'
+    CurVer = s 'Waters.$FilenameRoot$Server.1'
   }
   NoRemove CLSID
   {
-    ForceRemove $ProxyCLSID$ = s '$Company$ $FilenameRoot$Server Class'
+    ForceRemove $ProxyCLSID$ = s 'Waters $FilenameRoot$Server Class'
     {
-      ProgID = s '$Company$.$FilenameRoot$Server.1'
-      VersionIndependentProgID = s '$Company$.$FilenameRoot$Server'
+      ProgID = s 'Waters.$FilenameRoot$Server.1'
+      VersionIndependentProgID = s 'Waters.$FilenameRoot$Server'
       ForceRemove 'Programmable'
       LocalServer32 = s '%MODULE%'
       val AppID = s '%APPID%'
       'TypeLib' = s '$InstrTypeLib$'
     }
   }
 }
